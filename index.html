<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <title>Gastos+</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
  <div class="wrapper">
    <button id="toggleCards" class="floating-card-button">üí≥</button>

    <div id="cardModal" class="bottom-modal hidden">
      <div class="bottom-modal-box">
        <div class="modal-drag"></div>
        <h3>Novo Cart√£o</h3>
        <div class="modal-content">
          <input id="cardName" placeholder="Nome">
          <div class="card-dates">
            <input id="cardClose" type="number" min="1" max="31" placeholder="Fechamento">
            <input id="cardDue" type="number" min="1" max="31" placeholder="Vencimento">
          </div>
          <button id="addCardBtn">Adicionar</button>
          <ul id="cardList" class="card-list"></ul>
        </div>
        <button id="closeCardModal">Fechar</button>
      </div>
    </div>

    <div class="container operation-panel">
      <h2>Lan√ßar opera√ß√£o</h2>
      <div class="form-grid">
        <input id="desc" placeholder="Descri√ß√£o">
        <input id="value" type="number" placeholder="Valor (- despesa)">
        <select id="method"></select>
        <input id="opDate" type="date">
        <button id="addBtn">Adicionar</button>
      </div>
    </div>

    <div class="container">
      <div id="startGroup" class="container" style="display:flex;gap:10px;align-items:center;margin-bottom:16px">
        <label for="startInput">Saldo inicial:</label>
        <input id="startInput" type="number" style="flex:1">
        <button id="setStartBtn" style="flex:0 0 60px">OK</button>
      </div>
      <div class="table-wrapper">
        <table id="dailyTable">
          <thead>
            <tr><th>Data</th><th>Descri√ß√£o</th><th>Gasto</th><th>Saldo</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <button id="resetData" class="danger" style="margin-top:12px">Limpar TODOS</button>
    </div>
  </div>
  <script type="module" src="main.js"></script>
  <script>
    const tbody = document.querySelector("#dailyTable tbody");
    const startGroup = document.getElementById("startGroup");
    const setStartBtn = document.getElementById("setStartBtn");
    const startInput = document.getElementById("startInput");
    const addBtn = document.getElementById("addBtn");

    let saldo = null;

    setStartBtn.onclick = () => {
      const val = parseFloat(startInput.value);
      if (!isNaN(val)) {
        saldo = val;
        startGroup.style.display = "none";
        renderTable();
      }
    };

    addBtn.onclick = () => {
      const desc = document.getElementById("desc").value.trim();
      const value = parseFloat(document.getElementById("value").value.trim());
      const date = document.getElementById("opDate").value;
      const method = document.getElementById("method").value;

      if (!desc || isNaN(value) || !date) return alert("Preencha todos os campos.");
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${date.split("-").reverse().join("/")}</td>
        <td>${desc}</td>
        <td>${value.toFixed(2)}</td>
        <td></td>`;
      tbody.appendChild(tr);
    };

    function renderTable() {
      const trs = tbody.querySelectorAll("tr");
      let atual = saldo;
      trs.forEach(tr => {
        const td = tr.querySelectorAll("td");
        const gasto = parseFloat(td[2]?.textContent);
        if (!isNaN(gasto)) {
          atual += gasto;
          td[3].textContent = atual.toFixed(2);
        }
      });
    }
  </script>
</body>
</html>
