/* ===================== HEADER MODO CLARO ===================== */
html[data-theme="light"] .app-header {
  background: #fff !important;
  color: #222;
  box-shadow: 0 2px 8px rgba(0,0,0,0.07);
  border: 1px solid #e0e0e0;
}
html[data-theme="light"] .app-header::after {
  /* Higher-contrast green on white and restore sliding animation */
  background: linear-gradient(90deg, transparent, #16A34A 35%, transparent 65%) !important;
  background-repeat: no-repeat !important;          /* avoid tiling that can look static */
  background-size: 200% 100% !important;   /* was reset by background shorthand */
  animation: headerBar 8s linear infinite !important; /* ensure it slides in light too */
  will-change: background-position;                 /* hint smoother animation */
}
html[data-theme="light"] .logo-text {
  color: #000 !important;
  text-shadow: 0 0 8px #00FF8080, 0 0 2px #00FF8040 !important;
}

html[data-theme="light"] .year-indicator {
  color: #000;
}

/* Year selector light theme */
html[data-theme="light"] .year-item {
  background: rgba(0, 0, 0, 0.06);
  border: 1px solid rgba(0, 0, 0, 0.08);
  color: #111;
}

html[data-theme="light"] .year-item:hover {
  background: rgba(0, 0, 0, 0.12);
}

html[data-theme="light"] .year-item:active {
  background: rgba(0, 0, 0, 0.18);
}

html[data-theme="light"] .header-seg{
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 18px;
  padding: 0;
  height: 44px;
  background: transparent;
  border: none;
  box-shadow: none;
  margin-left: auto;
  margin-right: 8px;
}
html[data-theme="light"] .header-seg .seg-highlight{
  display: none;
  position: absolute;
  top: 2px; bottom: 2px; left: 2px;
  width: calc(50% - 2px);
  background: rgba(0,0,0,0.04);
  border-radius: 20px;
  will-change: transform;
  transition: transform .28s cubic-bezier(.5,1.5,.5,1);
  pointer-events: none;
}
html[data-theme="light"] .header-seg[data-selected="cards"] .seg-highlight{ transform: translateX(100%); }
html[data-theme="light"] .header-seg .seg-option{
  position: relative;
  width: 44px;
  height: 44px;
  border: 1px solid rgba(0,0,0,0.08);
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  z-index: 1;
}
html[data-theme="light"] .header-seg .seg-option:focus-visible{ outline: none; box-shadow: 0 0 0 2px rgba(0,207,255,0.12); border-radius: 18px; }
html[data-theme="light"] .header-seg .seg-option::before{
  content: '';
  width: 22px; height: 22px;
  background-color: #111; /* dark icons on light buttons */
  mask-repeat: no-repeat; -webkit-mask-repeat: no-repeat;
  mask-position: center;  -webkit-mask-position: center;
  mask-size: 100% 100%;   -webkit-mask-size: 100% 100%;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.12));
}
html[data-theme="light"] .header-seg .seg-option.active{
  background: var(--accent);
  color: #fff;
  border: 1px solid var(--accent);
  box-shadow: 0 6px 18px rgba(0,207,255,0.12);
}
html[data-theme="light"] .header-seg .seg-option.active::before{
  background-color: #fff; /* white icon on accent */
  filter: drop-shadow(0 1px 3px rgba(0,0,0,0.18));
}

/* ===================== MODO CLARO ===================== */
html[data-theme="light"] {
  --bg-main: #f7f7f7;
  --bg-card: #fff;
  --txt-main: #222;
  --txt-muted: #888;
  --accent: #00cfff;
  --divider: #e0e0e0;
}

html[data-theme="light"] html,
html[data-theme="light"] body {
  /* Force a light app background when the light theme is enabled.
     Keep dark-theme defaults untouched by scoping this rule to the
     html[data-theme="light"] root only. */
  background-color: var(--bg-main) !important;
  background-image: none !important;
  color: var(--txt-main);
}

/* Ensure the fixed backdrop used for the app background follows the
   light theme as well (doesn't change the dark default). */
html[data-theme="light"] #backdrop-base {
  background-color: var(--bg-main) !important;
}

/* Light theme: reduce bottom padding so no visible gap remains */
html[data-theme="light"] .wrapper {
  padding-bottom: calc(56px + env(safe-area-inset-bottom) + var(--kb-offset-bottom));
}
/* Align sticky divider position with the reduced padding in light theme */
html[data-theme="light"] hr.divider {
  bottom: calc(56px + env(safe-area-inset-bottom));
}

html[data-theme="light"] .card,
html[data-theme="light"] .month-divider,
html[data-theme="light"] .month-meta {
  background: var(--bg-card);
  color: var(--txt-main);
  border-color: var(--divider);
}

/* Fix clipped shadows for month headers in light theme only.
   Allow their immediate containers to show overflow (shadows), and
   ensure month dividers are painted above neighboring cards so their
   shadows are visible. This preserves spacing and alignment. */
html[data-theme="light"] #accordion,
html[data-theme="light"] #accordion details,
html[data-theme="light"] details.month {
  overflow: visible !important;
}

html[data-theme="light"] summary.month-divider {
  position: relative !important;
  z-index: 3; /* float above adjacent siblings so shadow isn't hidden */
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1), 0 8px 22px rgba(0,0,0,0.18);
}

/* Ensure following day cards don't create a higher stacking context */
html[data-theme="light"] details.day,
html[data-theme="light"] .executed-cash,
html[data-theme="light"] .planned-list > li {
  position: relative; z-index: 1;
}

/* Month headers in light theme should be dark/primary text, not accent green */
html[data-theme="light"] .month-name,
html[data-theme="light"] summary.month-divider,
html[data-theme="light"] summary.month-divider .month-name,
html[data-theme="light"] .month-divider .month-name {
  color: var(--txt-main) !important;
  text-shadow: none !important; /* remove neon/green glow used in dark theme */
}

/* Balance (saldo) text adjustments for light theme only */
html[data-theme="light"] summary.month-divider::before,
html[data-theme="light"] summary.month-divider .month-row,
html[data-theme="light"] summary.month-divider .month-row::after,
html[data-theme="light"] summary.month-divider .month-meta,
html[data-theme="light"] summary.month-divider .month-meta::before,
html[data-theme="light"] summary.month-divider .meta-label,
html[data-theme="light"] summary.month-divider .meta-value {
  text-shadow: none !important; /* remove dark-mode neon glow */
}

html[data-theme="light"] summary.month-divider .meta-label {
  color: var(--txt-muted) !important;
  font-weight: 500;
}

html[data-theme="light"] summary.month-divider .meta-value {
  color: var(--txt-main) !important;
  font-weight: 700; /* slightly heavier for clear contrast */
  font-size: 12pt;
}
html[data-theme="light"] summary.month-divider .meta-value,
html[data-theme="light"] summary.month-divider .month-meta,
html[data-theme="light"] summary.month-divider .meta-value *,
html[data-theme="light"] summary.month-divider .meta-value::before,
html[data-theme="light"] summary.month-divider .meta-value::after,
html[data-theme="light"] .month-meta .meta-value,
html[data-theme="light"] .month-meta .meta-value * {
  background: transparent !important;
  box-shadow: none !important;
  border: none !important;
  padding: 0 !important;
  border-radius: 0 !important;
  color: var(--txt-main) !important;
  overflow: visible !important;
}

/* Keep the balance aligned to the right as in original layout */
html[data-theme="light"] summary.month-divider .meta-value {
  margin-left: auto !important; /* preserve flex alignment */
}

html[data-theme="light"] .meta-label {
  color: var(--txt-muted);
}

html[data-theme="light"] .floating-add-button,
html[data-theme="light"] .floating-home-button {
  background-color: rgba(0,0,0,.05);
  color: var(--accent);
}

html[data-theme="light"] .toast {
  background: #fff;
  color: var(--txt-main);
  border: 1px solid var(--divider);
}

/* Day header (expanded) typography fixes for light theme only */
html[data-theme="light"] summary.day-summary {
  /* keep the existing background/spacing, only fix text colors */
  color: var(--txt-main) !important;
  text-shadow: none !important;
}

html[data-theme="light"] summary.day-summary > span:first-child {
  color: var(--txt-muted) !important;
  font-weight: 500 !important;
}

html[data-theme="light"] summary.day-summary .day-balance,
html[data-theme="light"] summary.day-summary > span:last-child {
  color: var(--txt-main) !important;
  font-weight: 600 !important;
}

/* Light theme: ensure executed/planned headers are readable on white */
html[data-theme="light"] .executed-header,
html[data-theme="light"] .planned-header {
  color: var(--txt-main) !important;
  text-shadow: none !important;
}
html[data-theme="light"] .executed-header::after {
  background: rgba(31,111,72,0.5) !important; /* soft green underline */
}
html[data-theme="light"] .planned-header::after {
  background: var(--blue) !important; /* keep blue but remove glow */
}

/* Ensure any decorative pseudo-elements don't add neon glow in light mode */
html[data-theme="light"] summary.day-summary::before,
html[data-theme="light"] summary.day-summary *::before,
html[data-theme="light"] summary.day-summary *::after {
  text-shadow: none !important;
  filter: none !important;
}

/* ===================== ACCORDION – LIGHT THEME ===================== */
/* Month header: lighter borders and dividers on white */
html[data-theme="light"] summary.month-divider{
  /* subtle contour to separate from white background */
  border: 1px solid rgba(0,0,0,0.08) !important;
}
html[data-theme="light"] summary.month-divider::before{
  border-color: rgba(0,0,0,0.14) !important;
  opacity: 1 !important; /* ensure the border is visible on white */
}
html[data-theme="light"] summary.month-divider .month-row::after,
html[data-theme="light"] .month-header-title::after{
  background-color: var(--divider) !important;
}

/* Executed block container and lines */
html[data-theme="light"] .executed-cash{
  background: var(--bg-card) !important;
  -webkit-backdrop-filter: blur(20px) saturate(160%);
          backdrop-filter: blur(20px) saturate(160%);
  border: 1px solid var(--divider) !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.12) !important;
}
html[data-theme="light"] .executed-cash .op-line{
  background: #fff !important;
  border: 1px solid rgba(0,0,0,0.06) !important;
  box-shadow: 0 1px 4px rgba(0,0,0,0.10) !important;
  color: var(--txt-main) !important;
}

/* Fine tuning: executed items typography and value colors for light theme */
html[data-theme="light"] .executed-cash .op-left {
  color: var(--txt-main) !important; /* description */
  font-weight: 600;
}
html[data-theme="light"] .executed-cash .timestamp {
  color: var(--txt-muted) !important; /* time */
  opacity: 1 !important;
}
html[data-theme="light"] .executed-cash .op-right .value {
  color: var(--txt-main) !important; /* default value color (fallback) */
  font-weight: 700;
}
/* Use explicit colors for negative/positive amounts on white background */
html[data-theme="light"] .executed-cash .op-right .value.negative {
  color: #dc2626 !important; /* red-600 */
  background: transparent !important;
  -webkit-background-clip: initial !important;
  background-clip: initial !important;
  -webkit-text-fill-color: initial !important;
}
html[data-theme="light"] .executed-cash .op-right .value.positive {
  color: #16a34a !important; /* green-600 */
  background: transparent !important;
  -webkit-background-clip: initial !important;
  background-clip: initial !important;
  -webkit-text-fill-color: initial !important;
}

/* Invoice card */
html[data-theme="light"] .invoice{
  background: var(--bg-card) !important;
  -webkit-backdrop-filter: blur(20px) saturate(160%);
          backdrop-filter: blur(20px) saturate(160%);
  border: 1px solid var(--divider) !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.12) !important;
}
html[data-theme="light"] .invoice > summary{ color: var(--txt-main) !important; }
html[data-theme="light"] .invoice > summary::before{ background-color:#111 !important; }

/* Light theme: status icons (salary, invoice, recurrence) as black glyphs */
html[data-theme="light"] .icon-salary,
html[data-theme="light"] .icon-invoice,
html[data-theme="light"] .icon-repeat{
  background-color: #111 !important; /* glyph color via mask */
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.12));
}
/* Invoice list should be flat in light theme too — no per-item cards/borders. 
   Keep card-like borders for other lists (executed/planned blocks) but
   override them inside the invoice so items render as a single, unbroken list. */
html[data-theme="light"] .invoice .executed-list li .op-line{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  color: var(--txt-main) !important;
}
/* Garantir que todos os elementos dentro da fatura no tema claro tenham texto visível */
html[data-theme="light"] .invoice .executed-list li .op-left span,
html[data-theme="light"] .invoice .executed-list li .op-right .value,
html[data-theme="light"] .invoice .executed-list li .timestamp {
  color: var(--txt-main) !important;
}

/* Swipe action icons on light bg: darker glyphs */
html[data-theme="light"] .swipe-actions .icon-action{ background-color:#111 !important; }

/* Sticky month header – light theme glass, colors and shadows */
html[data-theme="light"] .sticky-month{
  background: rgba(255,255,255,0.56) !important; /* more translucent */
  -webkit-backdrop-filter: saturate(180%) blur(34px);
    backdrop-filter: saturate(180%) blur(34px);
  border: 1px solid rgba(0,0,0,0.06) !important;
  /* remove drop shadow below; keep only subtle inner outline */
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.18) !important;
  color: var(--txt-main) !important;           /* no green tint in light */
  text-shadow: none !important;                /* remove neon glow */
  /* Let the soft drop shadow render past rounded corners */
  -webkit-clip-path: inset(-12px round 12px) !important;
          clip-path: inset(-12px round 12px) !important;
}
html[data-theme="light"] .sticky-month .month-row,
html[data-theme="light"] .sticky-month .month-meta,
html[data-theme="light"] .sticky-month .meta-label,
html[data-theme="light"] .sticky-month .meta-value{
  color: var(--txt-main) !important;
  text-shadow: none !important;
}
html[data-theme="light"] .sticky-month .meta-label{ color: var(--txt-muted) !important; font-weight:500; }
html[data-theme="light"] .sticky-month .month-row::after{ background-color: var(--divider) !important; }
/* Light theme: thin month meta separator pipe */
html[data-theme="light"] summary.month-divider .month-meta::before{
  color: var(--divider) !important;
  opacity: 1 !important;
}

/* Generic swipe rows inside accordion (outside invoice), readable on light bg */
html[data-theme="light"] .swipe-wrapper .op-line{
  background: #fff !important;
  color: var(--txt-main) !important;
  border: 1px solid rgba(0,0,0,0.06) !important;
  box-shadow: 0 1px 4px rgba(0,0,0,0.10) !important;
}

/* Planned rows inside accordion: align visuals with executed */
html[data-theme="light"] .planned-list li .op-line{
  background: #fff !important;
  color: var(--txt-main) !important;
  border: 1px solid rgba(0,0,0,0.06) !important;
  box-shadow: 0 1px 4px rgba(0,0,0,0.10) !important;
}
html[data-theme="light"] #accordion .plan-check{ border-color: var(--txt-muted) !important; }
html[data-theme="light"] #accordion .plan-check:checked{ background: var(--blue) !important; border-color: var(--blue) !important; }

/* Planned values inside accordion: match executed colors on light theme */
html[data-theme="light"] .planned-list .op-right .value {
  color: #111;                     /* default/fallback text color */
  background: none !important;     /* disable gradient text */
  -webkit-text-fill-color: initial !important;
  font-weight: 700;                /* match Executados in light */
}
html[data-theme="light"] .planned-list .op-right .value.negative {
  color: #dc2626 !important;       /* red-600, match Executados */
  background: transparent !important;
  -webkit-text-fill-color: initial !important;
}
html[data-theme="light"] .planned-list .op-right .value.positive {
  color: #16a34a !important;       /* same green used in Executados */
  background: transparent !important;
  -webkit-text-fill-color: initial !important;
}

/* Light theme: País / Moeda modal styles */
html[data-theme="light"] #currencyProfileModal .bottom-modal-box {
  background: var(--bg-card) !important;
  border: 1px solid var(--divider) !important;
  box-shadow: 0 8px 22px rgba(0,0,0,0.08) !important;
}
html[data-theme="light"] #currencyProfileModal .modal-content {
  background: transparent !important;
}
html[data-theme="light"] #currencyProfileModal h2,
html[data-theme="light"] #currencyProfileModal #currencyProfileList li {
  color: var(--txt-main) !important;
}
html[data-theme="light"] #currencyProfileModal #currencyProfileList li {
  border-bottom: 1px solid rgba(0,0,0,0.06) !important;
}
html[data-theme="light"] #currencyProfileModal .modal-close-btn {
  color: #111;
  opacity: 0.7;
}
html[data-theme="light"] #currencyProfileModal .modal-close-btn:hover {
  opacity: 1;
}

/* Adicione outros componentes conforme necessário, sempre prefixando com html[data-theme="light"] */
/* Planned modal layout (grid without DOM changes)
   Row 1: [Descrição] .......... [Valor]
   Row 2: [Método de pagamento] (left, under descrição)
*/
#plannedModal .planned-list > li { display: block; }
#plannedModal .planned-list > li .op-line {
  display: grid;
  grid-template-columns: 1fr auto;  /* left grows, right hugs content */
  grid-template-rows: auto auto;    /* row1 main, row2 method */
  column-gap: 12px;
  row-gap: 2px;
  align-items: center;
}
/* Flatten the .op-main wrapper so its children participate in the grid */
#plannedModal .planned-list > li .op-main { display: contents; }
/* Place left block (checkbox + descrição) on row 1, col 1 */
/* Planned modal: left block (checkbox + descrição + método) */
#plannedModal .planned-list > li .op-left {
  position: relative;
  --check-space: 44px; /* espaço fixo para checkbox + gap */
  grid-column: 1;
  grid-row: 1 / span 2;   /* ocupa as duas linhas do grid */
  min-width: 0;
  display: block;         /* empilha descrição + método */
}

/* Planned modal: método de pagamento (abaixo da descrição, alinha à descrição) */
#plannedModal .planned-list > li .op-left .method{
  display: block;
  margin-top: 4px;
  font-size: 0.9rem;
  color: var(--txt-muted);
  padding-left: var(--check-space) !important; /* alinha com a descrição */
}
/* Make .op-right contribute its children directly to the grid */
#plannedModal .planned-list > li .op-right {
  display: contents !important;
}
/* Value goes to row 1, col 2, aligned right */
#plannedModal .planned-list > li .op-right .value {
  grid-column: 2;
  grid-row: 1;
  justify-self: end;
  text-align: right;
  font-weight: 600;   /* match Executados default */
  font-size: 10pt;    /* match Executados */
}
/* Any other child inside .op-right (e.g., "Cartão Amex") becomes the method line under the description */
#plannedModal .planned-list > li .op-right > :not(.value) {
  grid-column: 1;
  grid-row: 2;
  justify-self: start;
  align-self: start;
  margin-top: 2px;
  font-size: 0.9rem;
  color: var(--txt-muted);
  margin-left: var(--check-space) !important;
  padding-left: 0 !important;
}

#plannedModal .subheader { color: #fff; }
#plannedModal .planned-list > li .op-left span:not(.method) { color: #fff; }
#plannedModal .planned-list .op-left input.plan-check + span { color: #fff; }
#plannedModal h3 { color: #FFFFFF; }

/* Planned modal: valor fixo à direita do cartão */
#plannedModal .planned-list > li .op-line{
  position: relative;              /* referência para o valor absoluto */
  padding-right: 96px !important;  /* reserva espaço p/ o valor */
}
#plannedModal .planned-list > li .op-right .value{
  position: absolute !important;
  right: 0;                     /* cola no interior do cartão */
  top: 50%;
  transform: translateY(-50%);
  margin: 0;
  justify-self: auto !important;   /* ignora grid */
  text-align: right !important;
  white-space: nowrap;
}
/* Value input with expense/income toggles */
.value-input-wrapper {
  position: relative;
}
.value-input-wrapper input {
  width: 100%;
  padding-right: 64px;
}
.value-toggle {
  position: absolute;
  top: 10px;
  bottom: 0;
  margin: auto 0;
  right: 12px;
  display: flex;
  gap: 8px;
}
.value-toggle button {
  width: 36px;
  height: 36px;
  border: none;
  background: rgba(255,255,255,0.2);
  cursor: pointer;
  border-radius: 6px;
  color: #fff;
  font-size: 0.9em;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Desbotar botões não ativos e glow para o ativo */
.value-toggle button:not(.active) {
  opacity: 0.3;
}

.value-toggle button.active[data-type="expense"] {
  box-shadow: 0 0 8px rgba(255, 0, 0, 0.6);
}

.value-toggle button.active[data-type="income"] {
  box-shadow: 0 0 8px rgba(0, 255, 0, 0.6);
}

.value-toggle button[data-type="expense"] {
  background: rgba(255, 0, 0, 0.2);
}
.value-toggle button[data-type="income"] {
  background: rgba(0, 255, 0, 0.2);
}
.value-toggle button.active[data-type="expense"] {
  background: rgba(255, 0, 0, 0.5);
}
.value-toggle button.active[data-type="income"] {
  background: rgba(0, 255, 0, 0.5);
}
/* Method pill-switch */
.method-switch {
  position: relative;
  display: flex;
  width: 100%;
  background: rgba(255,255,255,0.1);
  border-radius: 20px;
  overflow: hidden;
  margin-bottom: 0;
}
.method-switch .switch-option {
  flex: 1;
  padding: 10px 16px;
  background: none;
  border: none;
  color: rgba(255,255,255,0.8);
  font-weight: 500;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  z-index: 1;
  transition: color .3s ease;
  outline: none;
}
.method-switch .switch-option:focus {
  outline: none;
  box-shadow: none !important;
}
.method-switch .switch-option.active {
  color: #000;
  font-weight: 600;
}
.method-switch .switch-highlight {
  position: absolute;
  top: 0;
  bottom: 0;
  left: -1px;
  width: calc(50% + 2px);
  background: rgba(255,255,255,0.2);
  box-shadow: none;
  border-radius: inherit;
  will-change: transform;
  transition: transform .3s cubic-bezier(.5,1.5,.5,1);
  pointer-events: none;
}
/* Slide highlight based on selected method */
.method-switch[data-selected="Cartão"] .switch-highlight {
  transform: translateX(100%);
}
/* ===================== VARS ===================== */
:root{
  --bg-color:#1e1e1e;
  --bg-gradient:linear-gradient(to right,#1e1e1e 0%,#2a2a2a 100%);
  --panel:#fff;
  --border:#d1d5db;
  --radius:8px;
  --floating-footer-height: 96px;
  --modal-bottom-gap: calc(var(--floating-footer-height) + env(safe-area-inset-bottom));

  --green:#00FF00;
  --green-soft:#32FF84;
  --red:#FF3B30;
  --blue:#007AFF;

  --glass-bg: radial-gradient(circle at top left,
                   rgba(255,255,255,.08) 0%,
                   rgba(255,255,255,0) 70%),
                 rgba(42,42,44,.80);
  --glass-bg-light: radial-gradient(circle at top left,
                   rgba(255,255,255,.04) 0%,
                   rgba(255,255,255,0) 70%),
                 rgba(42,42,44,.25);
  --card-bg:rgba(255,255,255,.05);
  --txt-main:#fff;
  --txt-muted:#B3B3B3;
  --timestamp:#6b7280;
  /* Keyboard-aware offsets (aplicados só quando data-vv-kb=1) */
  --kb-offset-top: 0px;
  --kb-offset-bottom: 0px;
}

/* DISABLED: This was causing fixed elements to move with keyboard
html.keyboard-open {
  transform: translate3d(0, var(--kb-offset-top, 0px), 0);
  will-change: transform;
}
*/

html.keyboard-open.kb-lock-shift {
  transform: none !important;
  will-change: auto;
}

/* Global hard stop: if kb-lock-shift is present we never translate the root */
html.kb-lock-shift { transform: none !important; will-change: auto !important; }

/* CORREÇÃO CRÍTICA: kb-lock-shift deve funcionar independentemente de keyboard-open */
html.kb-lock-shift {
  transform: none !important;
  will-change: auto !important;
}

/* Dupla garantia - bloquear qualquer transform quando kb-lock-shift está ativo */
html.kb-lock-shift,
html.kb-lock-shift.keyboard-open {
  transform: none !important;
  will-change: auto !important;
}

/* FORÇA BRUTA: Modal aberto = zero transformação SEMPRE */
html.modal-open {
  transform: none !important;
  will-change: auto !important;
}

html.modal-open.keyboard-open {
  transform: none !important;
  will-change: auto !important;
}

/* Garantia tripla - qualquer combinação com modal aberto */
html.modal-open.kb-lock-shift,
html.modal-open.keyboard-open.kb-lock-shift {
  transform: none !important;
  will-change: auto !important;
}

/* iOS PWA Triple Fix: Modal + Keyboard - lock all fixed elements */
html.modal-open.keyboard-open .app-header,
html.modal-open.keyboard-open .floating-pill,
html.modal-open.keyboard-open .floating-add-button, 
html.modal-open.keyboard-open .floating-home-button,
html.modal-open.kb-lock-shift .app-header,
html.modal-open.kb-lock-shift .floating-pill,
html.modal-open.kb-lock-shift .floating-add-button, 
html.modal-open.kb-lock-shift .floating-home-button {
  transform: translate3d(0, 0, 0) !important;
  -webkit-transform: translate3d(0, 0, 0) !important;
  will-change: auto !important;
  position: fixed !important;
}

/* Força wrapper fixo quando modal aberto */
html.modal-open .wrapper {
  transform: none !important;
  will-change: auto !important;
  position: relative !important;
}

html.modal-open.keyboard-open .wrapper {
  transform: none !important;
  will-change: auto !important;
  position: relative !important;
}

/* ===================== CRITICAL iOS PWA KEYBOARD STABILITY ===================== */

/* When keyboard appears in iOS PWA, prevent ALL fixed elements from moving */
@media (display-mode: standalone) {
  html.keyboard-open .app-header,
  html.keyboard-open .floating-pill, 
  html.keyboard-open .floating-add-button,
  html.keyboard-open .floating-home-button,
  html[data-vv-kb="1"] .app-header,
  html[data-vv-kb="1"] .floating-pill,
  html[data-vv-kb="1"] .floating-add-button,
  html[data-vv-kb="1"] .floating-home-button {
    /* FORCE absolute stability - no transforms allowed */
    transform: translate3d(0, 0, 0) !important;
    -webkit-transform: translate3d(0, 0, 0) !important;
    
    /* Ensure they stay in compositor layer but don't move */
    will-change: auto !important;
    -webkit-will-change: auto !important;
    
    /* Force re-anchor to layout viewport, not visual viewport */
    position: fixed !important;
  }
  
  /* Additional enforcement for header */
  html.keyboard-open .app-header,
  html[data-vv-kb="1"] .app-header {
    top: 0 !important;
    inset-block-start: 0 !important;
  }
  
  /* Additional enforcement for bottom elements */
  html.keyboard-open .floating-pill,
  html.keyboard-open .floating-add-button, 
  html.keyboard-open .floating-home-button,
  html[data-vv-kb="1"] .floating-pill,
  html[data-vv-kb="1"] .floating-add-button,
  html[data-vv-kb="1"] .floating-home-button {
    bottom: calc(12px + env(safe-area-inset-bottom)) !important;
    inset-block-end: calc(12px + env(safe-area-inset-bottom)) !important;
  }
  
  /* Ultimate iOS PWA enforcement - override ANY potential transforms */
  html.modal-open .app-header,
  html.modal-open .floating-pill,
  html.modal-open .floating-add-button,
  html.modal-open .floating-home-button {
    transform: translate3d(0, 0, 0) !important;
    -webkit-transform: translate3d(0, 0, 0) !important;
    will-change: auto !important;
    position: fixed !important;
  }
}



h1,h2,h3,h4,
.executed-header,
.planned-header,
summary.month-divider,
.sticky-month{
  font-family:'SF Pro Display',system-ui,sans-serif;
  font-weight:700;
}

/* ===================== RESET/BASIC ===================== */
html,body {
  background-color: #1e1e1e;
  background-image: none !important;
  /* iOS 26: evitar background-attachment: fixed quebra o anchor do fixed */
  /* background-attachment: fixed;  REMOVIDO */
  isolation: isolate;
  height: 100%;
  overflow: hidden; /* rolagem no container principal (.wrapper) */
  max-width:100%;
  overflow-x:hidden;
  font-family:'SF Pro Display',system-ui,sans-serif;
  margin:0;
  padding:20px 10px 0;
}
.main-panel{
background: transparent !important;
box-shadow: none !important;
backdrop-filter: none !important;
-webkit-backdrop-filter: none !important;
border: none !important;
border-radius: 0 !important;
}

/* Backdrop base for dark background */
#backdrop-base {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #1e1e1e;
  z-index: -1;
  
  /* iOS 26 fix: Ensure backdrop extends fully behind browser chrome */
  width: 100vw;
  height: 100vh; /* Will be overridden by @supports rules above */
}
.app-hidden{visibility:hidden;}
.hidden{opacity:0!important;pointer-events:none!important;}
body{display:block;}
.wrapper{
  position: relative;
  width:100%;
  max-width:100%;
  /* Use small viewport to avoid initial iOS toolbar shrink clipping */
  height: 100vh;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain; /* evita bounce do body */
  
  /* iOS 26 fix: Ensure content respects safe areas on all sides */
  padding-left: constant(safe-area-inset-left);
  padding-left: env(safe-area-inset-left);
  padding-right: constant(safe-area-inset-right);
  padding-right: env(safe-area-inset-right);
  
  /* espaço do header fixo */
  padding-top: calc(80px + constant(safe-area-inset-top));
  padding-top: calc(80px + env(safe-area-inset-top));
  /* espaço para os botões flutuantes na base (permite o divider passar) */
  padding-bottom: calc(120px + env(safe-area-inset-bottom));
  /* scroll-padding-bottom removido para não alterar scrollIntoView/Home */
}

/* Spacer real no final do conteúdo do acordeão: mantém
   o último dia visível acima do pseudo‑footer SEM depender
   de reflows disparados pelo botão Home */
#accordion::after{
  content: '';
  display: block;
  height: calc(120px + env(safe-area-inset-bottom));
}

/* Divider no rodapé do conteúdo: sem grande espaçamento extra */
hr.divider{
  margin: 8px 0 2px;
  border: none;
  border-top: 1px solid rgba(255,255,255,0.15);
  position: sticky;
  bottom: calc(70px + env(safe-area-inset-bottom)); /* segura ligeiramente acima do pseudo-footer */
  z-index: 5;
  background: transparent;
}
/* Esconde divider e footer quando um modal está aberto para evitar sobreposição com o teclado */
html.modal-open hr.divider { display: none !important; }
html.modal-open .app-footer { visibility: hidden; }

/* Ensure the divider below the start group is hidden in dark/default mode
  but remains visible when the app is explicitly in light theme. Use
  a highly specific selector and !important to override accidental resets. */
html:not([data-theme="light"]) #dividerSaldo { display: none !important; }
html[data-theme="light"] #dividerSaldo { display: block !important; }

/* Floating bottom pill (Home/Ajustes) */
.floating-pill{
  /* iOS 26 PWA Fix: Prevent movement when keyboard appears */
  position:fixed;
  left: calc(24px + constant(safe-area-inset-left));
  left: calc(24px + env(safe-area-inset-left));
  bottom:calc(12px + env(safe-area-inset-bottom));
  z-index:1201;
  
  /* Critical iOS PWA keyboard stability */
  transform: none !important;
  will-change: auto !important;
  
  display:inline-flex; align-items:center; gap:0;
  height:50px; padding:6px; /* igual ao botão "+" */
  background:rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.15);
  box-shadow:0 10px 24px rgba(0,0,0,.35), inset 0 -2px 0 rgba(0,0,0,.18);
  border-radius:32px; /* metade de 64 para a mesma curvatura */
  -webkit-backdrop-filter: blur(10px) saturate(160%);
  backdrop-filter: blur(10px) saturate(160%);
}
.floating-pill .pill-option{
  position:relative;
  appearance:none; border:none; background:transparent; color:#fff; font-weight:700;
  height:100%; padding:0 18px; border-radius:32px; cursor:pointer;
  display:inline-flex; align-items:center; justify-content:center;
  -webkit-tap-highlight-color: transparent; outline: none;
}
.floating-pill .pill-highlight{
  position:absolute; left:6px; top:6px; height:calc(100% - 12px); width:50%; border-radius:9999px;
  background:linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.10));
  box-shadow:0 4px 14px rgba(0,0,0,.35);
  transition: transform .22s cubic-bezier(.22,1,.36,1), width .22s ease;
  pointer-events:none;
}
.floating-pill[data-selected="settings"] .pill-highlight{ transform: translateX(100%); }

/* Icons for pill */
.pill-icon{width:22px;height:22px;background:#fff;display:inline-block;}
.pill-icon.icon-home{mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M12 3l9 8h-3v9h-5v-6H11v6H6v-9H3z"/></svg>') no-repeat center/100%;-webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M12 3l9 8h-3v9h-5v-6H11v6H6v-9H3z"/></svg>') no-repeat center/100%;}
.pill-icon.icon-gear{mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M19.14,12.94a7.43,7.43,0,0,0,.05-1l2-1.55a.5.5,0,0,0,.12-.65l-1.9-3.29a.5.5,0,0,0-.6-.22l-2.35.95a7.1,7.1,0,0,0-1.73-1L14.4,3.5a.5.5,0,0,0-.5-.5H10.1a.5.5,0,0,0-.5.5L9.3,5.18a7.1,7.1,0,0,0-1.73,1l-2.35-.95a.5.5,0,0,0-.6.22L2.72,8.74a.5.5,0,0,0,.12.65l2,1.55a7.43,7.43,0,0,0,0,2l-2,1.55a.5.5,0,0,0-.12.65l1.9,3.29a.5.5,0,0,0,.6.22l2.35-.95a7.1,7.1,0,0,0,1.73,1l.3,1.68a.5.5,0,0,0,.5.5h3.8a.5.5,0,0,0,.5-.5l.3-1.68a7.1,7.1,0,0,0,1.73-1l2.35.95a.5.5,0,0,0,.6-.22l1.9-3.29a.5.5,0,0,0-.12-.65ZM12,15.5A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/></svg>') no-repeat center/100%;-webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M19.14,12.94a7.43,7.43,0,0,0,.05-1l2-1.55a.5.5,0,0,0,.12-.65l-1.9-3.29a.5.5,0,0,0-.6-.22l-2.35.95a7.1,7.1,0,0,0-1.73-1L14.4,3.5a.5.5,0,0,0-.5-.5H10.1a.5.5,0,0,0-.5.5L9.3,5.18a7.1,7.1,0,0,0-1.73,1l-2.35-.95a.5.5,0,0,0-.6.22L2.72,8.74a.5.5,0,0,0,.12.65l2,1.55a7.43,7.43,0,0,0,0,2l-2,1.55a.5.5,0,0,0-.12.65l1.9,3.29a.5.5,0,0,0,.6.22l2.35-.95a7.1,7.1,0,0,0,1.73,1l.3,1.68a.5.5,0,0,0,.5.5h3.8a.5.5,0,0,0,.5-.5l.3-1.68a7.1,7.1,0,0,0,1.73-1l2.35.95a.5.5,0,0,0,.6-.22l1.9-3.29a.5.5,0,0,0-.12-.65ZM12,15.5A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"/></svg>') no-repeat center/100%;}

/* Prefer 100svh where supported (stable initial viewport on iOS Safari) */
@supports (height: 100svh) {
  .wrapper { height: 100svh; }
}

/* iOS 26+ PWA optimization: use large viewport to match browser behavior 
   
   Background: iOS PWAs behave differently than Safari browser regarding viewport handling.
   Safari browser extends content behind dynamic chrome (address bar), but PWAs don't.
   
   Solution:
   - PWA (standalone): Use 100lvh (large viewport) to extend behind chrome like browser
   - Safari browser: Use 100lvh as well to extend behind address bar consistently
   
   This ensures consistent behavior between PWA and browser on iOS 26+.
   Fallback to 100svh for older iOS versions that don't support lvh/dvh.
*/
@supports (height: 100lvh) {
  /* PWA mode: Use large viewport to extend behind chrome */
  @media (display-mode: standalone) {
    .wrapper { 
      height: 100lvh; /* Large viewport height for PWA to extend behind chrome */
    }
    
    /* Ensure safe areas are properly handled in PWA mode */
    body {
      /* Force layout recalculation to ensure safe-area-inset values are available */
      min-height: 100lvh;
    }
    
    /* Ensure backdrops extend fully in PWA */
    #backdrop-base,
    .bottom-modal {
      height: 100lvh;
      width: 100vw;
    }
  }
  
  /* Safari browser: Also use large viewport to extend behind address bar */
  @media not (display-mode: standalone) {
    .wrapper { 
      height: 100lvh; /* Large viewport for Safari to extend behind address bar */
    }
    
    /* Ensure proper layout in Safari browser */
    body {
      min-height: 100lvh;
    }
    
    /* Ensure backdrops extend fully in Safari browser */
    #backdrop-base,
    .bottom-modal {
      height: 100lvh;
      width: 100vw;
    }
  }
}

/* iOS Safari fallback: Force large viewport even if @supports fails */
@media screen and (-webkit-min-device-pixel-ratio: 2) {
  .wrapper {
    /* Try to detect iOS Safari and force the large viewport */
    height: 100lvh !important;
  }
  
  body {
    min-height: 100lvh !important;
  }
  
  /* Fix modal backdrops and backdrop-base to extend fully */
  #backdrop-base,
  .bottom-modal {
    height: 100lvh !important;
    width: 100vw !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
}
input,select,textarea{font-size:16px!important;box-sizing:border-box;}
.value{white-space:nowrap;}
.value.negative,td.negative{
  background:linear-gradient(90deg,#FF4040 0%,#FF0000 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  color:transparent;
}
.value.positive,td.positive{
  background:linear-gradient(90deg,#00FF00 0%,#32FF84 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  color:transparent;
}

/* ===================== ICONS ===================== */
.icon-action{
  display:inline-block;
  width:24px;
  height:24px;
  background-color:#fff;
  mask-repeat:no-repeat;
  mask-position:center;
  mask-size:100%;
  -webkit-mask-repeat:no-repeat;
  -webkit-mask-position:center;
  -webkit-mask-size:100%;
  filter: drop-shadow(0 1px 2px #0008);
  -webkit-filter: drop-shadow(0 1px 2px #0008);
}
.icon-edit{
  mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75l11.06-11.06-3.75-3.75L3 17.25zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/></svg>');
  -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75l11.06-11.06-3.75-3.75L3 17.25zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/></svg>');
}
.icon-delete{
  mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>');
  -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>');
}

/* Ícone "home" para o botão flutuante esquerdo */
.icon-home{
  mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 3l9 8h-3v9h-4v-6H10v6H6v-9H3l9-8z"/></svg>');
  -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 3l9 8h-3v9h-4v-6H10v6H6v-9H3l9-8z"/></svg>');
  width:28px;
  height:28px;
}

/* ==== Category icons (monocromáticos via mask-image) ==== */
.icon-card{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3 4h18a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm0 4v2h18V8H3zm0 6v2h6v-2H3z"/></svg>');-webkit-mask-image:inherit;}
.icon-transporte{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M5 11l1-5a3 3 0 0 1 3-2h6a3 3 0 0 1 3 2l1 5v6a1 1 0 0 1-1 1h-1a1 1 0 0 1-1-1v-1H7v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6zm3 6a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm8 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>');-webkit-mask-image:inherit;}
.icon-moradia{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 3l9 8h-3v9h-4v-5H10v5H6v-9H3l9-8z"/></svg>');-webkit-mask-image:inherit;}
.icon-saude{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M21 8a7 7 0 0 0-13.9-1H3v14h18V8h-0zM13 6h2v3h3v2h-3v3h-2v-3h-3V9h3V6z"/></svg>');-webkit-mask-image:inherit;}
.icon-alimentacao{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M11 2v20h2V2h-2zm7 6c0-2.21-1.79-4-4-4v20h2v-7h2a2 2 0 0 0 2-2v-5zM6 4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h2v7h2V4H6z"/></svg>');-webkit-mask-image:inherit;}
.icon-mercado{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M7 18a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm10 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zM5 4H2v2h2l3.6 7.59L5.25 16H19v-2H7.42l1.1-2h7.45a2 2 0 0 0 1.79-1.1L21 6H6.42L5.7 4.65A1 1 0 0 0 5 4z"/></svg>');-webkit-mask-image:inherit;}
.icon-doacao{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 21s-7-4.35-7-10a5 5 0 0 1 9-3 5 5 0 0 1 9 3c0 5.65-7 10-7 10s-2-.86-4-2.28C10 20.14 12 21 12 21z"/></svg>');-webkit-mask-image:inherit;}
.icon-renda {
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M11 15h2v2h-2zm5-6c-.2-1.3-1.3-2-2-2-1.4-.1-2.4.9-2.5 1.9H8v2h3c0 .6.4 1 1 1s1 .4 1 1-.4 1-1 1H8v2h3.6c.1 1.1 1.1 2.1 2.5 2 1-.1 1.8-.9 2-2h2.4c-.2 2.6-2.6 4.4-5.4 4.4-3.1 0-5.6-2.5-5.6-5.6S8.9 4.4 12 4.4c2.7 0 4.9 1.8 5.4 4.2z"/></svg>') no-repeat center / contain;
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M11 15h2v2h-2zm5-6c-.2-1.3-1.3-2-2-2-1.4-.1-2.4.9-2.5 1.9H8v2h3c0 .6.4 1 1 1s1 .4 1 1-.4 1-1 1H8v2h3.6c.1 1.1 1.1 2.1 2.5 2 1-.1 1.8-.9 2-2h2.4c-.2 2.6-2.6 4.4-5.4 4.4-3.1 0-5.6-2.5-5.6-5.6S8.9 4.4 12 4.4c2.7 0 4.9 1.8 5.4 4.2z"/></svg>') no-repeat center / contain;
  background-color: #fff;
}
.icon-transfer{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M16 3l4 4-4 4V7H5V5h11V3zm-8 14H5v2h11v2l4-4-4-4v2H8z"/></svg>');-webkit-mask-image:inherit;}
.icon-fatura{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M6 2h9l5 5v15a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8 1.5V8h4.5L14 3.5zM8 13h8v2H8v-2zm0 4h8v2H8v-2z"/></svg>');-webkit-mask-image:inherit;}
.icon-outros{mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><circle cx="12" cy="12" r="3"/></svg>');-webkit-mask-image:inherit;}

.icon-money{
  display:inline-block;
  width:24px;
  height:24px;
  vertical-align:-2px;
  background:#fff;                       /* icon colour */
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M8 2h8l-1.5 3H9.5L8 2z"/><path fill="white" d="M7 6h10v2H7z"/><path fill="white" d="M12 22c-4.5 0-8-3.3-8-7.5C4 11 6.2 9 9 8.2V8a3 3 0 016 0v.2c2.8.8 5 2.8 5 6.3C20 18.7 16.5 22 12 22z"/><path fill="white" d="M12 11.5c-1.1 0-2 .9-2 2h-1v1h1v1H9v1h1a2 2 0 004 0c0-1.1-.9-2-2-2h-1v-1h1a1 1 0 000-2z"/></svg>') no-repeat center/contain;
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M8 2h8l-1.5 3H9.5L8 2z"/><path fill="white" d="M7 6h10v2H7z"/><path fill="white" d="M12 22c-4.5 0-8-3.3-8-7.5C4 11 6.2 9 9 8.2V8a3 3 0 016 0v.2c2.8.8 5 2.8 5 6.3C20 18.7 16.5 22 12 22z"/><path fill="white" d="M12 11.5c-1.1 0-2 .9-2 2h-1v1h1v1H9v1h1a2 2 0 004 0c0-1.1-.9-2-2-2h-1v-1h1a1 1 0 000-2z"/></svg>') no-repeat center/contain;
}

/* —— STATUS ICONES ————————————————————— */
.icon-salary,
.icon-invoice,
.icon-repeat{
  display:inline-block;
  width:24px;
  height:24px;
  position: relative;
  width: 44px;
  height: 44px;
  border: 1px solid #e0e0e0;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.18) !important;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  z-index: 1;
  color: #111;
  -webkit-mask-position:center;
          mask-position:center;
  -webkit-mask-size:100%;
          mask-size:100%;
}
.icon-salary{
  -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1v22"/><path d="M17 5H9a3 3 0 0 0 0 6h6a3 3 0 0 1 0 6H7"/></svg>');
          mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1v22"/><path d="M17 5H9a3 3 0 0 0 0 6h6a3 3 0 0 1 0 6H7"/></svg>');
  width:18px;
  height:18px;
  margin-left:12px;
  flex:0 0 18px;
}
.icon-invoice{
  -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3 4h18a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm0 4v2h18V8H3zm0 6v2h6v-2H3z"/></svg>');
          mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3 4h18a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm0 4v2h18V8H3zm0 6v2h6v-2H3z"/></svg>');
  width:18px;
  height:18px;
  margin-left:12px;
  flex:0 0 18px;
}
.icon-repeat{
  -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M12 6V3l-5 4 5 4V8c2.8 0 5 2.2 5 5s-2.2 5-5 5a5 5 0 0 1-4.7-3.4H6.1A7 7 0 0 0 12 19a7 7 0 0 0 0-14z"/></svg>');
          mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M12 6V3l-5 4 5 4V8c2.8 0 5 2.2 5 5s-2.2 5-5 5a5 5 0 0 1-4.7-3.4H6.1A7 7 0 0 0 12 19a7 7 0 0 0 0-14z"/></svg>');
}

/* --- Fine‑tune recurrence icon alignment --- */
.icon-repeat{
  width:18px;
  height:18px;
  margin-left:12px;
  flex:0 0 18px;      /* keeps size inside flex rows */
  vertical-align:middle;
}

/* linha separadora (opção A) */
summary.day-summary .icon-salary::before,
summary.day-summary .icon-invoice::before{
  content:'';
  display:inline-block;
  width:1px;
  height:12px;
  margin:0 6px;
  background:rgba(255,255,255,.18);
  vertical-align:middle;
}

/* ===================== HEADER/FOOTER ===================== */
.app-header{
  /* iOS 26 PWA Fix: Anchor to large viewport instead of visual viewport */
  position:fixed;
  top:0;
  left:0;
  right:0;
  z-index:1000;
  width:100%;
  height: calc(80px + constant(safe-area-inset-top));
  height: calc(80px + env(safe-area-inset-top));
  
  /* CRITICAL iOS PWA Fix: Prevent header from moving when keyboard appears */
  position: -webkit-sticky; /* iOS fallback */
  position: sticky;
  position: fixed; /* Final value wins, but sticky helps iOS understand intent */
  
  /* Use large viewport units to stay anchored during keyboard transitions */
  top: 0; /* Stay at true top of large viewport */
  
  display:flex;
  align-items:center;
  justify-content:space-between;
  
  /* iOS 26 fix: Respect safe areas on left/right sides */
  padding-left: calc(20px + constant(safe-area-inset-left));
  padding-left: calc(20px + env(safe-area-inset-left));
  padding-right: calc(20px + constant(safe-area-inset-right));
  padding-right: calc(20px + env(safe-area-inset-right));
  
  box-sizing:border-box;
  overflow:hidden;
  backdrop-filter:saturate(180%) blur(30px);
  -webkit-backdrop-filter:saturate(180%) blur(30px);
  box-shadow:inset 0 0 0 1px #FFFFFF1A, 0 4px 12px rgba(0,0,0,.3);
  background: rgba(42,42,44,0.8) !important;
  border:1px solid rgba(255,255,255,.08);
  border-bottom-left-radius:12px;
  border-bottom-right-radius:12px;
  
  /* fallback antigo + padrão atual */
  padding-top: constant(safe-area-inset-top);
  padding-top: env(safe-area-inset-top);
  
  /* iOS PWA keyboard stability */
  transform: none !important;
  will-change: auto !important;
}

/* ===================== iOS 26+ PWA KEYBOARD FIXES ===================== */

/* Critical fix: Prevent fixed elements from becoming mobile when keyboard appears */
@supports (-webkit-touch-callout: none) { /* iOS-specific */
  @media (display-mode: standalone) { /* PWA-specific */
    .app-header,
    .floating-pill,
    .floating-add-button,
    .floating-home-button {
      /* Force absolute positioning relative to initial viewport */
      position: fixed !important;
      
      /* Prevent any transforms that could make elements mobile */
      transform: translate3d(0, 0, 0) !important;
      -webkit-transform: translate3d(0, 0, 0) !important;
      
      /* Ensure proper stacking and no movement */
      will-change: auto !important;
      -webkit-will-change: auto !important;
      
      /* Use large viewport when available to stay anchored */
      position: -webkit-sticky;
      position: sticky;  
      position: fixed; /* Final value wins */
    }
    
    /* Header-specific iOS PWA fixes */
    .app-header {
      /* Stay at true top of large viewport, not visual viewport */
      top: 0 !important;
      inset-block-start: 0 !important;
    }
    
    /* Bottom elements: use large viewport bottom when keyboard is present */
    .floating-pill,
    .floating-add-button,
    .floating-home-button {
      /* Lock to large viewport bottom with safe area */
      bottom: calc(12px + env(safe-area-inset-bottom)) !important;
      inset-block-end: calc(12px + env(safe-area-inset-bottom)) !important;
    }
  }
}
.app-header::after{
  content:'';
  position:absolute;
  bottom:0;
  left:0;
  width:100%;
  height:2px;
  pointer-events:none;
  background:linear-gradient(90deg, transparent, #00FF00 30%, transparent 60%);
  background-size:200% 100%;
  animation:headerBar 8s linear infinite;
}
/* ===== Header segmented control (2 segmentos) ===== */
.header-seg{
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 18px;
  padding: 0;
  height: 44px;
  background: transparent;
  border: none;
  box-shadow: none;
  margin-left: auto; /* encosta no lado direito do header */
  margin-right: 8px;
}
.header-seg .seg-highlight{
  display: none;
  position: absolute;
  top: 2px; bottom: 2px; left: 2px;
  width: calc(50% - 2px);
  background: rgba(255,255,255,0.22);
  border-radius: 20px;
  will-change: transform;
  transition: transform .28s cubic-bezier(.5,1.5,.5,1);
  pointer-events: none;
}
.header-seg[data-selected="cards"] .seg-highlight{ transform: translateX(100%); }
.header-seg .seg-option{
  position: relative;
  width: 44px;
  height: 44px;
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.05);
  border-radius: 14px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.45);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  z-index: 1; /* acima do highlight */
}
.header-seg .seg-option:focus-visible{ outline: none; box-shadow: 0 0 0 2px #00FF00; border-radius: 18px; }
.header-seg .seg-option::before{
  content: '';
  width: 22px; height: 22px;
  background-color: #fff; /* ícones monocromáticos (consistentes com o app) */
  mask-repeat: no-repeat; -webkit-mask-repeat: no-repeat;
  mask-position: center;  -webkit-mask-position: center;
  mask-size: 100% 100%;   -webkit-mask-size: 100% 100%;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,.5));
}
.header-seg .seg-option.icon-calendar::before{
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M7 2h2v2h6V2h2v2h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2V2zm12 8H5v10h14V10zM7 8h10V6H7v2z"/></svg>') no-repeat center / 100%;
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M7 2h2v2h6V2h2v2h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2V2zm12 8H5v10h14V10zM7 8h10V6H7v2z"/></svg>') no-repeat center / 100%;
}
.header-seg .seg-option.icon-creditcard::before{
  /* Bar-chart / chart icon (three vertical bars). Keeps white fill so theme rules apply) */
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><rect x="3" y="10" width="4" height="11" rx="1"/><rect x="10" y="6" width="4" height="15" rx="1"/><rect x="17" y="3" width="4" height="18" rx="1"/></svg>') no-repeat center / 100%;
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><rect x="3" y="10" width="4" height="11" rx="1"/><rect x="10" y="6" width="4" height="15" rx="1"/><rect x="17" y="3" width="4" height="18" rx="1"/></svg>') no-repeat center / 100%;
}

/* esconder os botões antigos sem quebrar JS */
.legacy-hidden{ display:none !important; }
@keyframes headerBar{
  0%   {background-position:0 0;}
  100% {background-position:-200% 0;}
}
.logo-title{display:flex;align-items:center;gap:8px;margin-right:auto;}
.logo-text{font-weight:700;font-size:32pt;letter-spacing:.5pt;color:#fff;text-shadow:0 0 6px #00FF0040;margin-right:auto;}

/* Year selector button */
.logo-text-btn {
  background: none;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 0;
  font: inherit;
  color: inherit;
  -webkit-tap-highlight-color: transparent;
}

.logo-text-btn:hover {
  opacity: 0.9;
}

.logo-text-btn:active {
  opacity: 0.8;
}

.year-indicator {
  font-size: 16px;
  opacity: 0.8;
  transition: transform 0.2s ease;
}

.logo-text-btn:hover .year-indicator {
  transform: translateY(1px);
}

/* Year list modal */
.year-list {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.year-item {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background: rgba(255, 255, 255, 0.06);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 12px;
  cursor: pointer;
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--txt-main);
  transition: all 0.2s ease;
  -webkit-tap-highlight-color: transparent;
}

.year-item:hover {
  background: rgba(255, 255, 255, 0.12);
}

.year-item:active {
  background: rgba(255, 255, 255, 0.18);
  transform: scale(0.98);
}

.year-item.current {
  background: var(--green);
  color: #000;
  font-weight: 700;
}

.year-item.current:hover {
  background: var(--green);
  opacity: 0.9;
}

.app-footer{
  text-align:center;
  font-size:.75rem;
  color:#666;
  margin-top: 80px;
  padding-bottom: calc(64px + env(safe-area-inset-bottom)); /* ligeiro ajuste para exibir a versão acima */
}
.logo-test-tag{font-family:'Caveat',cursive;font-size:1rem;margin-left:4px;}

#syncNowBtn,#offlineIndicator{position:absolute;top:21px;z-index:1100;background:none;border:none;cursor:pointer;}
#syncNowBtn{right:124px;width:40px;height:40px;font-size:1.5rem;display:flex;align-items:center;justify-content:center;}
#offlineIndicator{right:172px;font-size:1.3rem;}
#enablePushBtn{position:absolute;top:21px;right:76px;width:40px;height:40px;font-size:1.3rem;background:none;border:none;cursor:pointer;}
#enablePushBtn.enabled{opacity:.6;}
.offline-icon{margin-right:0;font-size:1.2rem;color:#e74c3c;}
.offline-icon[hidden]{display:none;}

.icon-btn{background:none;border:none;font-size:1.2rem;color:var(--blue);cursor:pointer;margin-right:12px;}
.icon-btn.spin{animation:spin 1s linear infinite;}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

/* ===================== PANELS & CONTAINERS ===================== */

.container{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);padding:18px;margin-bottom:18px;}

.start-container {
  flex-direction: column;
  align-items: flex-start;
  background: var(--glass-bg);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: var(--radius);
  box-shadow: inset 0 0 0 1px #FFFFFF1A, 0 6px 20px rgba(0,0,0,.45);
  padding: 12px 18px;
  margin-bottom: 18px;
}
/* Hide start-container by default to prevent flash; main.js will show it via inline style when appropriate */
.start-container { display: none; }
/* Hide divider below start section by default to prevent flash; main.js will toggle it */
#dividerSaldo { display: none; }
.start-container .modal-title {
  font-family: 'SF Pro Display', system-ui;
  font-weight: 700;
  font-size: 1.2rem;
  color: #fff;
}

/* New layout for Saldo inicial row */
.start-input-row {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-top: 12px;
  width: 100%;
}

/* Override full-width for the OK button beside the input */
#startGroup .start-input-row #setStartBtn {
  width: auto;
  margin: 0;
  padding: 0 20px;
  height: 48px;
  white-space: nowrap;
}

.currency-input {
  flex: 1;
  background: var(--glass-bg);
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.6);
  border-radius: 9999px;
  padding: 14px 16px;
  font-size: 1rem;
  color: #fff;
  text-align: left;
}




/* Sólido apenas onde precisamos realmente (ex.: fatura) */
.invoice { background: #2b2b2d !important; }

/* Overlay dos modais: vidro com blur + transparência */
.bottom-modal {
  background: rgba(0,0,0,.35) !important;            /* dim suave */
  backdrop-filter: blur(16px) saturate(140%);
  -webkit-backdrop-filter: blur(16px) saturate(140%);
}

/* Caixa do modal: vidro escuro com leve textura/gradiente */
#plannedModal .bottom-modal-box,
#cardModal .bottom-modal-box,
#txModal .bottom-modal-box,
#deleteRecurrenceModal .bottom-modal-box,
#editRecurrenceModal .bottom-modal-box {
  background: var(--glass-bg) !important;             /* rgba(42,42,44,.80) + radial highlight */
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: inset 0 0 0 1px #FFFFFF1A, 0 6px 20px rgba(0,0,0,.45);
}
.year-list {
  overflow: auto;
  padding: 8px 0;
}

/* ===================== YEAR MODAL - LIGHT THEME (optional) ===================== */
/* Preserve the existing dark styling by default. If a light variant is
   required, add the attribute `data-theme="light"` on the `#yearModal`
   element; the following rules will only apply then. This avoids
   overriding the current dark appearance. */
/* Apply the light variant when either the modal has data-theme="light"
   or the entire page is in light mode (html[data-theme="light"]). */
#yearModal[data-theme="light"], html[data-theme="light"] #yearModal {
  color: #111; /* base text color for light variant */
}
#yearModal[data-theme="light"] .bottom-modal-box,
html[data-theme="light"] #yearModal .bottom-modal-box {
  background: #ffffff; /* solid white card for clear contrast */
  border: 1px solid rgba(0,0,0,0.06);
  box-shadow: 0 10px 30px rgba(0,0,0,0.28);
  color: #111;
}
#yearModal[data-theme="light"] .modal-drag,
html[data-theme="light"] #yearModal .modal-drag { background: #e6e6e6; }
#yearModal[data-theme="light"] h2,
html[data-theme="light"] #yearModal h2 { color: #111; }
#yearModal[data-theme="light"] .modal-close-btn,
html[data-theme="light"] #yearModal .modal-close-btn { color: #111; }

/* Year items: light cards with subtle borders and dark numbers */
#yearModal[data-theme="light"] .year-list,
html[data-theme="light"] #yearModal .year-list { background: transparent; }
#yearModal[data-theme="light"] .year-item,
html[data-theme="light"] #yearModal .year-item {
  background: #f7f7f7;
  border: 1px solid rgba(0,0,0,0.06);
  color: #111;
  box-shadow: none;
}
#yearModal[data-theme="light"] .year-item:hover,
html[data-theme="light"] #yearModal .year-item:hover { background: #f0f0f0; }
#yearModal[data-theme="light"] .year-item.current,
html[data-theme="light"] #yearModal .year-item.current {
  background: #e6ffe6; /* subtle pale green to match app accent */
  color: #003300;
  font-weight: 800;
}

/* Ensure the modal content scrollbars are styled lightly (where supported) */
#yearModal[data-theme="light"] .modal-content::-webkit-scrollbar,
html[data-theme="light"] #yearModal .modal-content::-webkit-scrollbar { width: 10px; }
#yearModal[data-theme="light"] .modal-content::-webkit-scrollbar-thumb,
html[data-theme="light"] #yearModal .modal-content::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.08); border-radius: 8px; }

/* Preserve default stacking so floating buttons remain visible above the modal backdrop */

/* ===================== LIGHT THEME — START (Saldo inicial) CARD ===================== */
html[data-theme="light"] .start-container{
  background: #ffffff; /* white card */
  border: 1px solid rgba(0,0,0,0.06);
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
}
html[data-theme="light"] .start-container .modal-title{ color:#111; }
html[data-theme="light"] .currency-input{
  background: #f3f4f6; /* light input */
  border: 1px solid rgba(0,0,0,0.06);
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.04);
  color:#111;
}
html[data-theme="light"] .currency-input::placeholder{ color: rgba(17,17,17,0.45); }
html[data-theme="light"] .currency-input:-ms-input-placeholder{ color: rgba(17,17,17,0.45); }
html[data-theme="light"] .currency-input::-ms-input-placeholder{ color: rgba(17,17,17,0.45); }
html[data-theme="light"] #startGroup .start-input-row #setStartBtn{
  background:#16a34a; color:#fff; border:none; box-shadow: 0 6px 12px rgba(22,163,74,0.12);
}


/* Hide the "Limpar tudo" (reset) buttons visually while keeping functionality intact */
#resetData,
#resetDataFloat {
  display: none !important;
  visibility: hidden !important;
  pointer-events: none !important;
}

/* If you have any .card or .summary etc using transparent, override: */
.card[style*="background: transparent"],
.summary[style*="background: transparent"] {
  background: var(--glass-bg) !important;
}

#setStartBtn,#addCardBtn,.bottom-modal-box #addCardBtn{
  background:#4CAF50;
  color:#fff;
  font-weight:bold;
  font-size:1rem;
  height:48px;
  border:none;
  border-radius:20px;
  cursor:pointer;
  margin: 12px auto 0;
  padding: 14px 0;
  width:100%;
  max-width: 280px;
}
#addBtn.disabled{opacity:.5;}

#addBtn {
  background: #08ba4f;
  color: #fff;
  border: none;
  border-radius: 9999px;
  padding: 14px 0;
  max-width: 290px;
  margin: 12px auto 0;
  width: 100%;
  font-weight: 600;
  font-size: 1rem;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
  transition: transform .2s ease;
  cursor: pointer;
}
#addBtn:hover {
  transform: scale(1.02);
}

/* ===================== LISTAS / ITENS ===================== */
.timestamp{display:block;font-size:.75em;color:var(--timestamp);margin:2px 0 0 12px;}
.op-item{display:flex;justify-content:space-between;align-items:flex-start;position:relative;padding-left:8px;}
.op-item .op-content{flex:1;}
.op-item .actions{margin-left:8px;display:flex;flex-direction:row;align-items:center;}
.op-item+.op-item::before{content:"";position:absolute;left:0;top:4px;bottom:4px;width:1px;background:#9ca3af;}
.subheader{font-weight:600;margin:6px 0 2px;font-size:.9rem;}
.plan-check{margin-right:6px;}

/* ===================== TABLE (legacy escondida) ===================== */
.table-wrapper table{width:100%;table-layout:fixed;border-collapse:collapse;display:none;}
.table-wrapper th,.table-wrapper td{border:1px solid var(--border);padding:8px;text-align:left;}

/* ===================== ACCORDION ===================== */
#accordion,#accordion details,#accordion summary{border:none;margin:0;background:transparent;}
#accordion details.month{border:none;background:transparent;padding:0;margin-bottom:20px;}
#accordion details{border:1px solid var(--border);border-radius:var(--radius);margin-bottom:8px;padding:0 8px;}
#accordion summary{cursor:pointer;font-weight:600;list-style:none;display:flex;align-items:center;gap:8px;}
#accordion summary::-webkit-details-marker{display:none;}
#accordion .month-summary::before{content:"▶";display:inline-block;margin-right:8px;transform:rotate(0);transition:transform .2s ease;}
#accordion details[open] .month-summary::before{transform:rotate(90deg);} 
#accordion .day-summary{display:flex;align-items:center;padding:10px 0;text-align:left;width:100%;}
#accordion .day-summary>span:last-child{margin-left:auto;}
#accordion .operations{padding-left:16px;margin-bottom:8px;position:relative;}

/* Day card */
summary.day-summary{
  height:64px;padding:0 16px;margin:8px auto;width:calc(100% - 32px);
  background:var(--glass-bg);border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.45);
  display:flex;justify-content:space-between;align-items:center;
  transition:transform .2s,box-shadow .2s;font-weight:500!important;color:#333!important;
  /* Clip any overlay/pseudo-elements to the rounded corners */
  overflow: hidden;
  position: relative;
}
summary.day-summary:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.55);} 
summary.day-summary::before{
  content:"▸";
  display:inline-block;
  margin-right:6px;
  font-size:1.2em;
  transition:transform .2s ease;
  top:1px;
  /* ensure the marker/pseudo doesn't produce sharp corners when overlaid */
  border-radius: inherit;
  box-sizing: border-box;
}

.details.day[open] > summary.day-summary,
summary.day-summary.active{border:2px solid var(--green);background:rgba(42,42,44,.9);} 

/* Indicador rotacionado */
details.day[open] > summary.day-summary::before{transform:rotate(90deg);} 
details.day:not([data-has="true"]) > summary.day-summary::before{visibility:hidden;}
summary.day-summary > span:first-child{font-weight:400!important;letter-spacing:-.2px;font-size:12pt;color:#E0FFE0;}
summary.day-summary .day-balance, summary.day-summary > span:last-child{font-family:'SF Pro Display',sans-serif;font-weight:600;font-size:12pt;color:#E0FFE0;white-space:nowrap;}

details.day{border:none!important;border-radius:0!important;padding-left:8px!important;margin:12px 0!important;background:transparent!important;}
details.day.today summary.day-summary{width:calc(100% - 24px)!important;margin:4px 12px 4px 0!important;padding:8px 12px!important;background:linear-gradient(135deg,rgba(255,255,255,.12) 0%,rgba(255,255,255,.06) 100%)!important;border:4px solid #fff;border-radius:12px!important;box-shadow:0 0 12px 2px rgba(255,255,255,.4);} 
details.day.negative summary.day-summary{width:calc(100% - 24px)!important;margin:4px 12px 4px 0!important;padding:8px 12px!important;background:var(--glass-bg)!important;box-shadow:0 0 8px 0 rgba(255,64,64,.6)!important;border:2px solid rgba(255,64,64,.5);border-radius:6px!important;}

/* Light theme: mirror the red negative highlight for day headers */
html[data-theme="light"] details.day.negative summary.day-summary{
  width: calc(100% - 24px) !important;
  margin: 4px 12px 4px 0 !important;
  padding: 8px 12px !important;
  background: var(--bg-card) !important;
  /* stronger blood-red highlight for negative days on light bg */
  box-shadow: 0 0 10px 0 rgba(153, 27, 27, 0.50) !important; /* #991b1b @ 50% */
  border: 2px solid #991b1b !important;
  border-radius: 6px !important;
}

/* Light theme: distinctive highlight for today's day header (mirrors dark intent) */
html[data-theme="light"] details.day.today summary.day-summary{
  width: calc(100% - 24px) !important;
  margin: 4px 12px 4px 0 !important;
  padding: 8px 12px !important;
  background: var(--bg-card) !important;
  border: 3px solid rgba(31, 111, 72, 0.45) !important; /* green accent for clarity */
  border-radius: 12px !important;
  box-shadow: 0 0 12px 2px rgba(31, 111, 72, 0.25), 0 8px 24px rgba(0,0,0,0.08) !important;
}
details.day:not(.today):not(.negative) summary.day-summary{width:calc(100% - 24px)!important;margin:4px 12px 4px 0!important;padding:8px 12px!important;}

/* Neon bar */
details.day:not([data-has="true"]){
  border-left:1px solid rgba(255,255,255,0.12) !important; /* traço claro para dias vazios */
}
details.day[data-has="true"]{border-left:4px solid var(--green-soft)!important;border-radius:3px;}
details.month:not([open]) > details.day{border-left:none!important;}
details.month:not([open]) > details.day::before{display:none!important;}
details.day[data-has="true"] > summary.day-summary::before{color:var(--green-soft)!important;}

/* ===================== DAY HEADER ACCENTS - LIGHT THEME ===================== */
/* Mirror dark-mode mechanics but use darker, readable shades on white */
html[data-theme="light"] details.day[data-has="true"]{
  border-left: 4px solid #1f6f48 !important; /* darker green suited for light bg */
  border-radius: 3px;
}

html[data-theme="light"] details.day[data-has="true"] > summary.day-summary::before{
  color: #1f6f48 !important; /* triangle */
  filter: drop-shadow(0 2px 6px rgba(31,111,72,0.10)) !important;
}

html[data-theme="light"] details.day[data-has="true"] > summary.day-summary{
  /* keep original sizing/padding; only adjust highlight visuals */
  background: var(--bg-card) !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.06), 0 0 10px rgba(31,111,72,0.06) !important;
}

html[data-theme="light"] summary.day-summary:hover{
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.08), 0 0 12px rgba(31,111,72,0.08) !important;
}

/* ensure the rotated/open state triangle stays visible and colored */
html[data-theme="light"] details.day[open] > summary.day-summary::before{
  color: #1f6f48 !important;
  filter: drop-shadow(0 2px 6px rgba(31,111,72,0.12)) !important;
}

/* Replicate the dark-mode 'open' glow for day headers but toned for light bg */
html[data-theme="light"] details.day[open] > summary.day-summary,
html[data-theme="light"] summary.day-summary.active{
  border: 2px solid rgba(31,111,72,0.14) !important;
  background: var(--bg-card) !important;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08), 0 0 22px rgba(31,111,72,0.12) !important;
}

/* Slightly stronger glow when the open summary is hovered (keeps interaction feedback) */
html[data-theme="light"] details.day[open] > summary.day-summary:hover,
html[data-theme="light"] summary.day-summary.active:hover{
  box-shadow: 0 10px 28px rgba(0,0,0,0.10), 0 0 28px rgba(31,111,72,0.14) !important;
}

.today-row{background:linear-gradient(90deg,#3c3c3e 0%,#4a4a4c 100%);font-weight:600;letter-spacing:-.3px;box-shadow:0 0 6px rgba(255,255,255,.1);border-radius:8px;}

/* ===================== MONTH HEADER / STICKY ===================== */
summary.month-divider{
  position:relative;display:flex;flex-direction:column;gap:4px;width:100%;box-sizing:border-box;
  height:100px;padding:18px 24px 12px;margin:20px 0;
  background:var(--glass-bg-light);backdrop-filter:blur(30px) saturate(180%);
  box-shadow:inset 0 0 0 1px #FFFFFF1A, 0 4px 12px rgba(0,0,0,.45);border-radius:12px;
  font-weight:700;font-size:18pt;text-transform:uppercase;letter-spacing:.5pt;color:#348461;text-shadow:0 0 6px #00FF0040;

}
summary.month-divider::before{content:'';position:absolute;inset:0;border-radius:12px;border:1px solid #5a5a5a;opacity:.35;pointer-events:none;text-shadow:0 0 6px #00FF0040;box-sizing:border-box;}
/* Ensure the month divider container clips any overlay pseudo-elements to its rounded corners */
summary.month-divider{overflow:hidden;}
summary.month-divider .month-row{display:flex;align-items:center;width:100%;font-weight:700;font-size:18pt;text-transform:uppercase;letter-spacing:.5pt;position:relative;gap:12px;text-shadow:0 0 6px #00FF0040;}
summary.month-divider .month-row::after{content:"";flex-grow:1;height:1px;background-color:#3e3e40;text-shadow:0 0 6px #00FF0040;}
.month-header-title{position:relative;display:flex;align-items:center;}
.month-header-title::after{content:"";flex-grow:1;height:1px;background-color:#3e3e40;margin-left:12px;border-radius:999px;box-sizing:border-box;}
/* Round the thin divider in month row so its ends are not sharp */
summary.month-divider .month-row::after{
  content:"";
  flex-grow:1;
  height:1px;
  background-color:#3e3e40;
  text-shadow:0 0 6px #00FF0040;
  border-radius:999px;
  box-sizing:border-box;
}
summary.month-divider .month-meta{display:flex!important;justify-content:space-between;align-items:center;width:100%;font-size:12pt;font-weight:500;text-shadow:0 0 6px #00FF0040;}
summary.month-divider .month-meta::before{content:'|';margin-right:6px;opacity:.7;text-shadow:0 0 6px #00FF0040;}
summary.month-divider .meta-label{text-transform:none;font-size:12pt;color:rgba(255,255,255,.7);font-weight:400;text-shadow:0 0 6px #00FF0040;}
summary.month-divider .meta-value{margin-left:auto;font-size:12pt;color:#fff;font-weight:600;text-shadow:0 0 6px #00FF0040;}
details.month > summary:not(.month-divider),details.month > .month-meta{display:none!important;}
.month-meta{display:none!important;}

.sticky-month{
  position:fixed;top:80px;left:0;width:100%;padding:0 24px 4px;box-sizing:border-box;font-weight:bold;font-size:14pt;color:#348461;
  background:var(--glass-bg-light);backdrop-filter:blur(30px) saturate(180%);
  box-shadow:inset 0 0 0 1px #FFFFFF1A, 0 4px 12px rgba(0,0,0,.45);z-index:900;display:flex;align-items:flex-end;height:52px;border-radius:12px;
  overflow:hidden;-webkit-clip-path:inset(0 round 12px);clip-path:inset(0 round 12px);
  opacity:0;visibility:hidden;pointer-events:none;text-shadow:0 0 6px #00FF0040;
  transition:opacity .2s ease, visibility .2s ease;
}
.sticky-month.visible{opacity:1;visibility:visible;pointer-events:auto;}

/* ===================== EXECUTADOS / PLANEJADOS BLOCKS ===================== */
.executed-cash{
  padding:14px 10px;
  background:var(--glass-bg);
  backdrop-filter:blur(30px) saturate(180%);
  -webkit-backdrop-filter:blur(30px) saturate(180%);
  border-radius:12px;
  box-shadow:inset 0 0 0 1px #FFFFFF1A, 0 6px 20px rgba(0,0,0,.45);
  margin:10px 0 8px;
}
.executed-header,.planned-header{
  font-weight:700;
  font-size:12pt;
  color:#fff;
  margin-bottom:8px;
  position:relative;
  font-family:'SF Pro Display',system-ui,sans-serif;
  text-shadow:0 0 6px #00FF0040;
}
.executed-header::after{content:'';position:absolute;left:0;right:0;bottom:-4px;height:1px;background:var(--green);text-shadow:0 0 6px #00FF0040;} 
.planned-header::after{content:'';position:absolute;left:0;right:0;bottom:-4px;height:1px;background:var(--blue);text-shadow:0 0 6px #00FF0040;} 

.executed-list,.planned-list{list-style:none;padding:0;margin:0;}
.executed-list li,.planned-list li{list-style:none;margin:10px 0;padding:0;}

.executed-cash .op-line{
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:2px;
  height:64px;
  padding:0 10px;
  background:var(--card-bg);
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,.30);
  color:#fff;
}
.op-main{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  flex-wrap:nowrap;
  width:100%;
}
.executed-cash .op-left{
  display:flex;
  align-items:center;
  gap:8px;
  font-weight:500;
  font-size:12pt;
  color:#fff;
  flex:1 1 auto;
  min-width:0;
}
.executed-cash .timestamp{margin:0;font-weight:400;font-size:8pt;color:#bbbbbb;align-self:flex-start;}
/* Place timestamp under description for Planned list */
.planned-cash .timestamp{ margin:0; font-weight:400; font-size:8pt; color: var(--timestamp); }
/* Layout for description + recurrence icon on one row */
.op-left .left-text{ display:flex; flex-direction:column; min-width:0; }
.op-left .left-title{ display:flex; align-items:center; gap:6px; min-width:0; }
.op-left .left-title .invoice-payment-badge{
  display:inline-flex;
  align-items:center;
  padding:2px 6px;
  border-radius:999px;
  background:rgba(0, 123, 255, 0.18);
  color:var(--blue);
  font-size:0.65rem;
  font-weight:600;
  letter-spacing:0.03em;
  text-transform:uppercase;
}
html[data-theme="light"] .op-left .left-title .invoice-payment-badge{
  background:rgba(0, 86, 179, 0.12);
}
.executed-cash .op-right{
  display:flex;
  align-items:center;
  gap:16px;
  margin-left:auto;
  flex:0 0 auto;
}
.executed-cash .op-right .value{font-weight:600;font-size:10pt;}

/* Checkbox (planejados) */
#plannedModal .planned-cash input[type="checkbox"], #plannedModal .planned-cash .plan-check{
  width:24px;height:24px;border:2px solid var(--txt-muted);border-radius:6px;background:transparent;-webkit-appearance:none;appearance:none;cursor:pointer;position:relative;
}
#plannedModal .planned-cash input[type="checkbox"]:checked, #plannedModal .planned-cash .plan-check:checked{background-color:var(--blue);border-color:var(--blue);} 

/* Planned modal: render circular checkbox via the description span, keep native input clickable */
#plannedModal .planned-list .op-left{ position: relative; }
#plannedModal .planned-list .op-left input.plan-check {
  width: 24px;
  height: 24px;
  border: 2px solid var(--txt-muted);
  border-radius: 6px;
  background: transparent;
  appearance: none;
  -webkit-appearance: none;
  display: inline-block;
  margin: 0;
  padding: 0;
  flex-shrink: 0;
  align-self: center;
  box-sizing: border-box;
  cursor: pointer;
}

#plannedModal .planned-list .op-left input.plan-check:checked {
  background: var(--blue);
  border-color: var(--blue);
}


/* ===== Accordion planned items: match modal checkbox style ===== */
#accordion .plan-check,
.executed-list .plan-check {
  width: 24px;
  height: 24px;
  border: 2px solid var(--txt-muted);
  border-radius: 6px;
  background: transparent;
  -webkit-appearance: none;
          appearance: none;
  cursor: pointer;
  margin-right: 6px;
}
#accordion .plan-check:checked,
.executed-list .plan-check:checked {
  background: var(--blue);
  border-color: var(--blue);
}

/* ---- Alignment fix for planned rows inside accordion ---- */
.planned-list .op-left{
  display:flex;
  align-items:center;
  gap:8px;
  flex:1 1 auto;
  min-width:0;
  font-weight:500;   /* match Executados */
  font-size:12pt;    /* match Executados */
}
.planned-list .op-right .value{
  font-weight:600;  /* match Executados default */
  font-size:10pt;   /* match Executados */
}
.planned-list .op-left .icon-repeat{
  margin-left:4px;      /* tighter gap from checkbox */
  margin-right:0;
  flex:0 0 18px;
  vertical-align:middle;
}

/* ===================== SWIPE ===================== */
.swipe-wrapper {
  position: relative;
  overflow: hidden;
}

/* ==== Card modal: high-contrast glass-style cards ==== */
#cardModal .swipe-wrapper .card-line {
  background: var(--glass-bg-light);          /* lighter glass for contrast */
  border: 1px solid rgba(255,255,255,0.12);   /* subtle white border */
  border-radius: 12px;                        /* larger rounding */
  box-shadow: 0 4px 12px rgba(0,0,0,0.6);      /* stronger shadow */
  margin-top: 12px !important;                /* more vertical spacing */
  padding: 16px;                              /* slightly more padding */
  color: #fff;                                /* ensure readability */
}

.swipe-wrapper .op-line {
  background: var(--card-bg); /* was: var(--panel) */
  color: #fff;
  border-radius: 12px;      /* match your card corners */
  padding: 12px;            /* reduced from 16px or previous value */
  margin-top: 8px !important;
  transition: transform .2s ease;
  box-sizing: border-box;
  width: 100%;
  max-width: 100%;
}
.swipe-actions {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  gap: 24px;
  padding: 0 24px;
  /* Match container by default: reveal only icons */
  background: transparent !important;
  z-index: 2;
  opacity: 0;
  transition: opacity .15s linear;
}
.swipe-actions button{display:inline-flex;justify-content:center;align-items:center;padding:0;background:none;border:none;cursor:pointer;transition:transform .15s ease;}
.swipe-actions button:hover{transform:scale(1.1);} 
.swipe-actions .edit{color:var(--blue);} 
.swipe-actions .danger{color:var(--red);} 


.swipe-actions .icon-action{
  width:24px;
  height:24px;
  background-color:#fff;
  display:block;
}
/* Pay icon */
.icon-pay{
  -webkit-mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M21 7H3V5h18v2zm0 2H3v10h18V9zM5 15h6v2H5v-2zm12.59-4.41L16 12.17l-1.59-1.58L13 12l3 3 4-4-1.41-1.41z"/></svg>');
          mask-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M21 7H3V5h18v2zm0 2H3v10h18V9zM5 15h6v2H5v-2zm12.59-4.41L16 12.17l-1.59-1.58L13 12l3 3 4-4-1.41-1.41z"/></svg>');
}

/* Offset swipe‑actions inside invoice items so they reveal fully despite 12 px padding */
.invoice .executed-list li .swipe-actions{
  gap: 24px;               /* match spacing in Planned/Executed */
  padding: 0 24px;         /* same inner padding */
  background: transparent !important;   /* let container's glass-bg show through */
}
/* Swipe actions for invoice header summary */
.invoice-header-line{ position: relative; overflow: hidden; }
.invoice-header-line .invoice-label,
.invoice-header-line .invoice-total{ position: relative; z-index:1; }

/* ===================== INVOICE ===================== */
.invoice{
  margin:12px 0;
  background:var(--glass-bg);
  backdrop-filter:blur(30px);
  -webkit-backdrop-filter:blur(30px);
  border-radius:12px;
  border:1px solid var(--blue);
  box-shadow:inset 0 0 0 1px #FFFFFF1A, 0 6px 20px rgba(0,0,0,.45);
  padding:16px;
}

/* Divider azul apenas quando a fatura estiver expandida (entre o cabeçalho e a lista) */
details.invoice[open] > summary{
  position: relative;
  flex-wrap: wrap; /* allow the divider pseudo-element to span the full width */
  padding-bottom: 12px; /* space for the divider */
  overflow: visible;
}

details.invoice[open] > summary::after{
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 1px;
  background: var(--blue);
}

.invoice > summary{
  padding:14px 16px;
  display:flex;
  align-items:baseline;
  gap:8px;
  font-weight:700;
  font-size:12pt;
  color:#fff;
  font-family:'SF Pro Display', system-ui, sans-serif;
  flex-wrap: wrap;
}

.invoice > summary .invoice-label,
.invoice > summary .invoice-total{
  line-height: 1;
  display: inline-block;
}

.invoice > summary .invoice-total{
  margin: 0 0 0 auto; /* override bottom margin so it doesn't push down */
  display: inline-flex;            /* stack amount + note vertically */
  flex-direction: column;
  align-items: flex-end;
}

.invoice > summary::before{
  content:"";
  display:inline-block;
  width:24px;
  height:24px;
  background-color:#fff;
  /* Apply the SVG mask correctly for all engines */
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3 4h18a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm0 4v2h18V8H3zm0 6v2h6v-2H3z"/></svg>') no-repeat center / 100%;
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3 4h18a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm0 4v2h18V8H3zm0 6v2h6v-2H3z"/></svg>') no-repeat center / 100%;
}

.invoice-total{
  font-family:'SF Pro Display', system-ui, sans-serif;
  font-weight:600;
  font-size:12pt;
  text-align:right;
  color:var(--red);
  margin-bottom:8px;
}

/* Visual for post-payment states on invoice header */
.invoice-total .amount.struck{
  text-decoration: line-through;
  opacity:.75;
}
.invoice-total .note{
  display:block;
  margin-top:2px;
  font-size:10pt;
  font-weight:500;
  color:#e5e7eb;
}

.invoice.positive .invoice-total{color:var(--green-soft);}

.invoice .executed-list{
  display:flex;
  flex-direction:column;
}

.invoice .executed-list li{
  list-style: none;
  margin: 0;
  padding: 0;                         /* no side padding on the wrapper */
  position: relative;                 /* required for absolute swipe-actions */
}

/* Invoice operation line left side */
 .invoice .op-left{
   display:flex;
   align-items:center;
   gap:8px;
   font-weight:500;
   font-size:12pt;
   color:var(--op-left-color);
   flex:1 1 auto;
   min-width:0;
 }

/* Invoice operation line right side: align value to right */
.invoice .op-right {
  margin-left: auto;
}

.invoice .op-right .value {
  font-family: 'SF Pro Display', system-ui, sans-serif;
  font-weight: 600;
  font-size: 10pt;
  text-align: right;
}

/* --- ALIGNMENTS INSIDE CARD INVOICE OPERATIONS ---------------------------------- */
/* Garantir: descrição à esquerda, valor numérico à direita, timestamp abaixo da descrição */
.invoice .executed-list { list-style: none; padding: 0; margin: 0 0 32px 0; }
.invoice .executed-list li { list-style: none; padding: 0; margin: 0; }
.invoice .executed-list li .op-line{
  display: flex;
  flex-direction: column;
  gap: 2px;
  height: auto;
  padding: 0 12px 12px 12px;          /* small horizontal indent + slightly larger spacing below each item */
  background: transparent !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  color: #fff;
  box-sizing: border-box;
}
.invoice .executed-list li .op-main{
  display: flex;
  justify-content: space-between;   /* same behaviour as Planned/Executed */
  align-items: center;
  gap: 12px;                        /* identical horizontal gap */
  width: 100%;
}
.invoice .executed-list li .op-left{
  display:flex;
  align-items:center;
  gap:8px;
  font-weight:500;
  font-size:12pt;
  color:var(--op-left-color);
  flex:1 1 auto;
  min-width:0;
}
.invoice .executed-list li .op-right{
  margin-left: auto;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  flex: 0 0 auto;
  gap: 16px;                        /* match Planned/Executed spacing */
}
.invoice .executed-list li .timestamp {
  font-weight: 400;
  font-size: 8pt;
  color: var(--timestamp);
  margin: 0;
  display: block;
}

/* Group date heading inside invoice */
.invoice .invoice-group-date{
  margin: 16px 0 4px 0; /* slightly more space after the header divider */
  font-weight: 700;
  font-size: .95rem;
  color: var(--txt-main);
}
.invoice .invoice-divider{ height:1px; background: rgba(255,255,255,.12); margin: 6px 0 0 0; }
.invoice .invoice-divider.thin{ opacity:.9; }
.invoice .invoice-divider.bold{ height:2px; opacity:.9; }

/* Light theme adjustments for new flat invoice list */
/* Ensure invoice list items stay flat on light backgrounds */
html[data-theme="light"] .invoice .executed-list li .op-line{
  color: #111 !important;
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}
html[data-theme="light"] .invoice .invoice-divider{ background: var(--divider) !important; opacity: 1; }
html[data-theme="light"] .invoice .invoice-group-date{ color: #111; }

/* Ensure the swipe wrapper fills the entire card width so the value can reach the right edge */
.invoice .executed-list li .swipe-wrapper {
  flex: 1 1 100%;
  width: calc(100% - 24px); /* account for left+right padding on .op-line so swipe area aligns visually */
  margin-left: 12px;        /* keep swipe area aligned with the indented content */
}

/* ===================== MODAL ===================== */
.bottom-modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;justify-content:center;align-items:flex-end;z-index:1100;transition:opacity .3s ease;pointer-events:none;opacity:0;padding:0 16px calc(var(--modal-bottom-gap) + var(--kb-offset-bottom, 0px));box-sizing:border-box;}
.backdrop-blur{backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);} 
.bottom-modal:not(.hidden){opacity:1;pointer-events:auto;}
/* ===================== MODAL BOX (Bottom Sheet) ===================== */
/* ===================== MODAL BOX (Bottom Sheet) ===================== */
.bottom-modal-box {
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(20px) saturate(200%);
  -webkit-backdrop-filter: blur(20px) saturate(200%);
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 20px;
  box-shadow:
    inset 0 8px 16px rgba(0,0,0,0.3),
    0 8px 24px rgba(0,0,0,0.6),
    0 12px 36px rgba(0,0,0,0.7);
  padding: 18px;
  box-sizing: border-box;
  width: calc(100% - 8px);
  max-width: 480px;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  margin-bottom: 0;
  overscroll-behavior: contain;

  transform: translateY(10px) scale(0.97);
  opacity: 0;
  transition:
    transform .16s cubic-bezier(.22,1,.36,1),
    opacity   .16s ease;
}

.bottom-modal:not(.hidden) .bottom-modal-box {
  transform: translateY(0) scale(1);
  opacity: 1;
}

/* ===================== SETTINGS (Ajustes) ===================== */
.sheet-modal {
  top: calc(80px + constant(safe-area-inset-top));
  top: calc(80px + env(safe-area-inset-top));
  padding-top: 12px;
  align-items: flex-end;
}

.sheet-modal .bottom-modal-box {
  min-height: calc(100vh - (80px + constant(safe-area-inset-top)) - var(--modal-bottom-gap, 0px) - 24px);
  min-height: calc(100vh - (80px + env(safe-area-inset-top)) - var(--modal-bottom-gap, 0px) - 24px);
  max-height: calc(100vh - (80px + constant(safe-area-inset-top)) - var(--modal-bottom-gap, 0px) - 24px);
  max-height: calc(100vh - (80px + env(safe-area-inset-top)) - var(--modal-bottom-gap, 0px) - 24px);
}

#settingsModal .modal-content {
  padding: 0 0 24px;
}


.sheet-header {
  flex: 0 0 auto;
  margin: 0 0 12px;
  padding: 8px 0 4px;
  text-align: left;
}

.sheet-header h2 {
  margin: 0;
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--txt-main);
  text-shadow: none;
}

#settingsModal .settings-modal-header {
  padding-top: 10px;
  padding-bottom: 6px;
}

#settingsModal .modal-drag {
  margin-bottom: 6px;
}
/* Settings modal – alignment and avatar fallback */
#settingsModal .settings-card{ padding:14px; }
#settingsModal .settings-list{ margin-top:12px; }
#settingsModal .settings-profile{ align-items:center; gap:12px; }
#settingsModal .settings-names{ min-width:0; }
#settingsModal .settings-name, 
#settingsModal .settings-sub{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
/* Hide IMG alt text when the network image fails to avoid layout shift */
#settingsModal .settings-avatar img{ font-size:0; line-height:0; display:block; width:100%; height:100%; object-fit:cover; }
.settings-card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:18px;padding:12px;margin:6px 0 14px 0;box-shadow:0 6px 16px rgba(0,0,0,.3);}
.settings-profile{display:flex;align-items:center;gap:12px;}
.settings-avatar{width:56px;height:56px;border-radius:50%;background:#333;flex:0 0 auto;overflow:hidden;border:1px solid rgba(255,255,255,.15);}
.settings-avatar img{width:100%;height:100%;object-fit:cover;display:block;}
.settings-names{display:flex;flex-direction:column;}
.settings-name{font-weight:800;font-size:1.05rem;color:#fff;}
.settings-sub{font-size:.9rem;color:#c9c9c9;opacity:.9;}
.settings-list{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:18px;overflow:hidden;}
.settings-item{display:flex;align-items:center;justify-content:space-between;padding:14px 14px;border-top:1px solid rgba(255,255,255,.06);}
.settings-item:first-child{border-top:none;}

.settings-list .settings-item.settings-link{
  background:none;
  border:none;
  width:100%;
  text-align:left;
  color:inherit;
  font:inherit;
  cursor:pointer;
}
.settings-list .settings-item.settings-link:focus{
  outline:none;
}
.settings-list .settings-item.settings-link:focus-visible{
  box-shadow:inset 0 0 0 2px var(--focus-ring, #f59e0b);
  border-radius:0; /* relies on container radius */
}

/* Theme selector card (iOS-like group) */
.settings-theme-card{
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 18px;
  padding: 0 !important; /* flush selector row */
  margin: 6px 0 14px 0;
  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
}
.settings-theme-card #themeButtons{display:flex;gap:0;}
.settings-theme-card .theme-header{
  display:flex;
  align-items:center;
  padding:0 12px;
  height:48px;
  font-weight:700;
  color:var(--txt-main);
}
.settings-theme-card .theme-row{
  display:flex;
  width:100%;
  height:48px;
  margin:0 !important;
  padding:0 !important;
  box-sizing:border-box;
  border-top:1px solid rgba(255,255,255,0.03);
  border-radius:0 0 18px 18px;
  overflow:hidden; /* clip inner pressed highlight to rounded container */
}
.settings-theme-card .theme-row .theme-btn{
  flex:1 1 0;
  border:none;
  margin:0 !important;
  padding:0 !important;
  text-align:center;
  background:transparent;
  color:var(--txt-main);
  font-size:1.05rem;
  position:relative;
  display:flex; align-items:center; justify-content:center; height:100%;
  -webkit-tap-highlight-color:transparent;
}
.settings-theme-card .theme-row .theme-btn + .theme-btn::before{
  content:""; position:absolute; left:-0.5px; top:0; bottom:0; width:1px; background:rgba(15,23,34,0.06);
}

/* Selected state (no jump), pressed state sinks; both keep rounded outer corners */
.settings-theme-card .theme-row .theme-btn[aria-pressed="true"]{
  background: linear-gradient(180deg, rgba(0,0,0,0.10), rgba(0,0,0,0.04));
  color:var(--txt-main);
  box-shadow: 0 6px 18px rgba(2,6,23,0.22) inset;
  transform:none;
}
.settings-theme-card .theme-row .theme-btn:active{
  transform: translateY(4px);
  box-shadow: 0 6px 18px rgba(2,6,23,0.22) inset;
}

/* Ensure outer corners follow the card when pressed/selected */
.settings-theme-card .theme-row .theme-btn:first-child:is([aria-pressed="true"], :active){
  border-radius: 18px 0 0 18px !important; /* full left side */
}
.settings-theme-card .theme-row .theme-btn:last-child:is([aria-pressed="true"], :active){
  border-radius: 0 18px 18px 0 !important; /* full right side */
}

/* Feather under the pressed/selected button, clipped to the row */
.settings-theme-card .theme-row .theme-btn:is([aria-pressed="true"], :active)::after{
  content:""; position:absolute; left:0; right:0; bottom:-8px; height:12px;
  background: radial-gradient(ellipse at center, rgba(0,0,0,0.28), rgba(0,0,0,0));
  filter: blur(8px); pointer-events:none;
}
.settings-theme-card .theme-row .theme-btn:first-child:is([aria-pressed="true"], :active)::after{
  border-radius: 0 0 0 18px;
}
.settings-theme-card .theme-row .theme-btn:last-child:is([aria-pressed="true"], :active)::after{
  border-radius: 0 0 18px 0;
}

/* Accessible focus ring that follows rounded corners */
.settings-theme-card .theme-row .theme-btn:focus{ outline: none; }
.settings-theme-card .theme-row .theme-btn:focus-visible{
  box-shadow: inset 0 0 0 2px var(--focus-ring, #f59e0b);
}
.settings-theme-card .theme-row .theme-btn:first-child:focus-visible{ border-radius: 18px 0 0 18px; }
.settings-theme-card .theme-row .theme-btn:last-child:focus-visible{ border-radius: 0 18px 18px 0; }

/* Version section styles */
.version-row {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0;
}

.version-number {
  color: var(--txt-main);
  font-size: 0.9rem;
  font-weight: 500;
  opacity: 0.8;
}

/* Make the version row visually match other settings-item rows */
#settingsModal .settings-item .version-number{ font-weight:700; font-size:1rem; color:var(--txt-main); opacity:0.9; }
#settingsModal .settings-item .settings-cta{ padding:0; }

.settings-item .left{display:inline-flex;align-items:center;gap:10px;color:#fff;font-weight:700;}
.settings-item .settings-cta{color:#fff;font-weight:800;}
.settings-item.danger .settings-cta{color:#ff6b6b;}
.settings-item.danger .settings-icon{background:#ff6b6b;}
.settings-item .right{color:#cfcfcf;}
.settings-item.danger .left{color:#ff6b6b;}
.settings-icon{width:22px;height:22px;background:#fff;display:inline-block;border-radius:6px;}
.settings-icon.icon-logout{mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M10 3H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h4v-2H6V5h4V3zm9.707 8.293-4-4-1.414 1.414L16.586 11H11v2h5.586l-2.293 2.293 1.414 1.414 4-4a1 1 0 0 0 0-1.414z"/></svg>') no-repeat center/100%;-webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M10 3H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h4v-2H6V5h4V3zm9.707 8.293-4-4-1.414 1.414L16.586 11H11v2h5.586l-2.293 2.293 1.414 1.414 4-4a1 1 0 0 0 0-1.414z"/></svg>') no-repeat center/100%;}
.settings-cta{appearance:none;border:none;background:transparent;color:inherit;font:inherit;display:flex;align-items:center;gap:10px;padding:0;cursor:pointer;-webkit-tap-highlight-color:transparent;}

/* Restrict fields when paying an invoice */
#txModal[data-mode="pay-invoice"] .method-switch,
#txModal[data-mode="pay-invoice"] #cardSelector,
#txModal[data-mode="pay-invoice"] #recurrence,
#txModal[data-mode="pay-invoice"] .value-toggle {
  display: none !important;
}

/* Parcelamento – toggle bonito e compatível (Chrome/Safari) */
#txModal[data-mode="pay-invoice"] #invoiceParcelRow{
  display:flex !important;
  flex-direction: row;                 /* texto à esquerda, toggle à direita */
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  padding: 6px 2px 0 2px;
  color:#e5e7eb;
  font-weight:700;
  font-size:12pt;
}
/* Garante alinhamento vertical perfeito entre label e toggle */
#txModal[data-mode="pay-invoice"] #invoiceParcelRow > span:first-child{
  display: inline-flex;
  align-items: center;
  height: 30px;               /* igual ao trilho do toggle */
  line-height: 30px;
}
#txModal[data-mode="pay-invoice"] #invoiceParcelRow input[type="checkbox"]{
  -webkit-appearance: none;
  appearance: none;
  width: 52px; height: 30px;
  border-radius: 999px;
  background: linear-gradient(180deg, #3a3a3c, #2b2b2d);
  border: 1px solid rgba(0,0,0,.45);
  box-shadow: inset 0 2px 4px rgba(0,0,0,.4);
  position: relative;
  cursor: pointer;
  outline: none;
  transition: background .2s ease;
  flex: 0 0 auto;
  overflow: hidden;
  vertical-align: middle;
  margin: 0;                  /* evita desníveis por margens default do iOS */
}
#txModal[data-mode="pay-invoice"] #invoiceParcelRow input[type="checkbox"]::before{
  content: "";
  position: absolute;
  top: 3px; left: 3px;
  width: 24px; height: 24px;
  border-radius: 50%;
  background: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,.35);
  transition: transform .2s ease;
}
#txModal[data-mode="pay-invoice"] #invoiceParcelRow input[type="checkbox"]:checked{
  background: linear-gradient(180deg, var(--green-soft), #22c55e);
}
#txModal[data-mode="pay-invoice"] #invoiceParcelRow input[type="checkbox"]:checked::before{
  transform: translateX(22px);
}

/* Select de parcelas em estilo pill */
#txModal[data-mode="pay-invoice"] #parcelasBlock{ margin-top: 6px; }
#txModal[data-mode="pay-invoice"] #parcelasBlock select{
  width: 100%;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.15);
  background: rgba(255,255,255,0.08);
  color: #fff;
  -webkit-appearance: none;
  appearance: none;
}
#txModal[data-mode="pay-invoice"] #parcelasBlock select:focus{
  outline: none;
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(0,122,255,.2);
}
.bottom-modal:not(.hidden) .bottom-modal-box {
  transform: translateY(0) scale(1);
  opacity: 1;
}

/* Inputs and selects in modal box */
.bottom-modal-box input,
.bottom-modal-box select,
.bottom-modal-box input[type="date"] {
  background: rgba(255,255,255,0.1);
  border-radius: 16px;
  padding: 12px 16px;
  font-size: 1rem;
  color: rgba(255,255,255,0.9);
  transition: background .2s, border-color .2s, box-shadow .2s;
  outline: none;
  box-shadow: inset 0 12px 4px rgba(0,0,0,0.2), 0 4px 12px rgba(0,0,0,0.4);
}
/* Focused input/select in modal box */
.bottom-modal-box input:focus,
.bottom-modal-box select:focus,
.bottom-modal-box input[type="date"]:focus {
  background: rgba(255,255,255,0.25);
  border-color: var(--blue);
  box-shadow: inset 0 1px 4px rgba(0,0,0,0.2),
              0 4px 12px rgba(0,0,0,0.3);
}
::placeholder {
  font-size: 0.95rem;
  font-weight: 500;
  color: rgba(255,255,255,0.7);
}
.modal-drag{width:40px;height:4px;background:#ccc;border-radius:2px;margin:0 auto 12px;} 
.modal-content{flex:1;overflow-y:auto;width:100%;padding:0 24px 0 2px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;} 

#txModal .modal-content {
  padding: 0;
  display: flex;
  flex-direction: column;
}

#txModal .form-grid {
  display: flex;
  flex-direction: column;
  gap: 12px;
  flex: 1 1 auto;
}

.sheet-footer {
  flex: 0 0 auto;
}

#txModal .tx-modal-footer {
  margin-top: auto;
  padding-top: 24px;
  display: flex;
  justify-content: center;
}

#cardModal .card-modal-footer {
  display: flex;
  justify-content: center;
  padding-top: 12px;
}
.modal-close-btn{
  position:absolute;
  top:16px;
  right:16px;
  background:none;
  border:none;
  font-size:1.5rem;
  color:#fff;
  opacity:0.8;
  cursor:pointer;
  width:auto;
  height:auto;
  padding:4px;
  line-height:1;
  z-index:1001;
}
.modal-close-btn:hover {
  opacity: 1;
}

.bottom-modal-box h2 {
  color: rgba(255,255,255,0.9);
  text-shadow: 0 0 4px rgba(0,0,0,0.4);
}
.bottom-modal-box input:not([type="radio"]):not([type="checkbox"]), .bottom-modal-box select {
  font-size:1rem;
  border-radius:16px;
  padding:10px;
  border:none;
  background:#fff;
  box-shadow:inset 0 1px 4px rgba(0,0,0,.1);
  margin-bottom:10px;
  width:100%;
  box-sizing:border-box;
}
/* Card dates row in modal */
.bottom-modal-box .card-dates{display:flex;gap:10px;margin-bottom:10px;}

/* Darken card-list background and white text */
.card-list li .card-line {
  background: rgba(255,255,255,0.1);
  border-radius: 12px;
  padding: 12px;
  color: #fff;
}
.card-list li .card-line .card-name,
.card-list li .card-line .card-dates {
  color: #fff;
}
select,input[type="date"]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border:none;border-radius:16px;padding:10px;font-size:1rem;width:100%;box-shadow:inset 0 1px 4px rgba(0,0,0,.1);} 

/* ===================== FORMS (cards etc.) ===================== */
.form-grid{display:grid;gap:10px;grid-template-columns:1fr;}
.form-grid input,.form-grid select{padding:10px;border:2px solid #000;border-radius:16px;font-size:1rem;width:100%;}

/* Layout helpers */

.form-row {
  display: flex;
  gap: 12px;
}
.form-row > * {
  flex: 1 1 0;
  min-width: 0;
  height: 44px;
  border-radius: 12px;
}

/* Card selector: vertical, checkbox-style radios */
#cardSelector {
  display: flex;
  flex-direction: column;
  gap: 8px;
  width: 100%;
  margin-bottom: 10px;
}
#cardSelector label {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: var(--glass-bg);
  border-radius: 12px;
  color: #fff;
  font-size: 1rem;
  cursor: pointer;
}
#cardSelector input[type="radio"] {
  appearance: none;
  -webkit-appearance: none;
  width: 24px;
  height: 24px;
  border: 2px solid var(--txt-muted);
  border-radius: 50%;
  background: transparent;
  cursor: pointer;
  position: relative;
  margin: 0;
}

#cardSelector input[type="radio"]:checked {
  background-color: var(--blue);
  border-color: var(--blue);
}

/* Field sizing */
.bottom-modal-box input#value {
  width: 100%;
  height: 56px;
  font-size: 1.1rem;
  font-weight: 500;
}
.bottom-modal-box input#desc {
  width: 100%;
  height: 48px;
  font-size: 1rem;
}
.bottom-modal-box input#opDate {
  width: 100%;
  height: 44px;
}

/* Button prominence */
#addBtn {
  width: 100%;
  padding: 18px 0;
  border-radius: 20px;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.2), 0 4px 12px rgba(0,0,0,0.4);
  font-weight: 600;
  font-size: 1rem;
}
.card-dates{display:flex;gap:10px;margin-bottom:10px;}
.card-list{list-style:none;padding:0;margin-top:10px;}
.card-list li{display:flex;flex-direction:column;gap:2px;border-radius:8px;padding:4px 0;}
.card-list li .card-line{display:flex;justify-content:space-between;align-items:center;gap:10px;position:relative;z-index:1;background:var(--panel);padding:8px 16px;transition:transform .2s ease;}
.card-line .card-name{font-weight:bold;font-size:1rem;}
.card-line .card-dates{font-size:.875rem;color:#444;}
.card-list li .card-actions{display:flex;justify-content:flex-end;gap:6px;margin-left:8px;}
.card-list li .card-actions button{width:40px;height:32px;font-size:1rem;border-radius:12px;border:2px solid #000;background:#fff;cursor:pointer;flex:1;}
.card-list li .card-info,.card-list li .card-meta{display:flex;justify-content:space-between;align-items:center;}

/* ===================== FLOATING BUTTONS ===================== */
.floating-add-button{
  /* iOS 26 PWA Fix: Prevent movement when keyboard appears */
  position:fixed;
  bottom:calc(12px + env(safe-area-inset-bottom));
  right: calc(24px + constant(safe-area-inset-right));
  right: calc(24px + env(safe-area-inset-right));
  z-index:1201;overflow:hidden;width:64px;height:64px;border-radius:50%;background-color:rgba(255,255,255,.05);
  backdrop-filter:blur(12px) saturate(180%);-webkit-backdrop-filter:blur(12px) saturate(180%);
  border:none;box-shadow:0 4px 10px rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;color:#fff;font-size:32px;font-weight:600;cursor:pointer;transition:transform .12s ease, box-shadow .12s ease;box-sizing:border-box;
  animation:pulse 4s ease-in-out infinite;
  
  /* Hard‑clip the rotated button so corners never bleed */
  clip-path: circle(50% at 50% 50%);
  -webkit-tap-highlight-color: transparent;
  
  /* CRITICAL iOS PWA keyboard stability */
  transform: none !important;
  will-change: auto !important;
}
/* Espelho do botão flutuante de adicionar: leva ao dia atual */
.floating-home-button{
  position:fixed;
  bottom:calc(12px + env(safe-area-inset-bottom));
  left: calc(24px + constant(safe-area-inset-left));
  left: calc(24px + env(safe-area-inset-left));
  z-index:1201;overflow:hidden;width:64px;height:64px;border-radius:50%;background-color:rgba(255,255,255,.05);
  backdrop-filter:blur(12px) saturate(180%);-webkit-backdrop-filter:blur(12px) saturate(180%);
  border:none;box-shadow:0 4px 10px rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;color:#fff;font-size:32px;font-weight:600;cursor:pointer;transition:transform .12s ease, box-shadow .12s ease;box-sizing:border-box;
  animation:pulse 4s ease-in-out infinite;
  clip-path: circle(50% at 50% 50%);
  -webkit-tap-highlight-color: transparent;
}
.floating-add-button:hover{
  transform:scale(.97);
  box-shadow:0 6px 16px rgba(0,0,0,.6), 0 0 12px #00FF0080;
}
.floating-home-button:hover{
  transform:scale(.97);
  box-shadow:0 6px 16px rgba(0,0,0,.6), 0 0 12px #00FF0080;
}
.floating-add-button:active{
  transform:scale(.97);
  box-shadow:0 3px 8px rgba(0,0,0,.4);
}
.floating-home-button:active{
  transform:scale(.97);
  box-shadow:0 3px 8px rgba(0,0,0,.4);
}

/* Light theme: pseudo-footer buttons tuning (glass, borders, icons, shadows) */
html[data-theme="light"] .floating-add-button,
html[data-theme="light"] .floating-home-button{
  background: rgba(255,255,255,0.78) !important;
  -webkit-backdrop-filter: blur(12px) saturate(180%) !important;
          backdrop-filter: blur(12px) saturate(180%) !important;
  border: 1px solid rgba(0,0,0,0.08) !important;
  box-shadow: 0 8px 20px rgba(0,0,0,0.12) !important;
  color: var(--accent) !important; /* plus sign uses currentColor */
}
html[data-theme="light"] .floating-add-button::before,
html[data-theme="light"] .floating-home-button::before{
  border: 1px solid rgba(0,0,0,0.08) !important;
  opacity: 1 !important; /* visible contour on white */
}
/* Softer hover/press without neon glow */
html[data-theme="light"] .floating-add-button:hover,
html[data-theme="light"] .floating-home-button:hover{
  box-shadow: 0 10px 24px rgba(0,0,0,0.16) !important;
}
html[data-theme="light"] .floating-add-button:active,
html[data-theme="light"] .floating-home-button:active{
  box-shadow: 0 6px 12px rgba(0,0,0,0.12) !important;
}

/* Light theme: bottom segmented pill (Home/Ajustes) */
html[data-theme="light"] .floating-pill{
  background: rgba(255,255,255,0.86) !important;
  border: 1px solid rgba(0,0,0,0.08) !important;
  box-shadow: 0 10px 24px rgba(0,0,0,0.16), inset 0 -2px 0 rgba(255,255,255,0.6) !important;
}
html[data-theme="light"] .floating-pill .pill-option{
  color: #111 !important;
}
html[data-theme="light"] .floating-pill .pill-highlight{
  background: linear-gradient(180deg, rgba(0,0,0,0.06), rgba(0,0,0,0.02)) !important;
  box-shadow: 0 4px 12px rgba(0,0,0,0.10) !important;
}
/* Light theme: make masked glyphs dark */
html[data-theme="light"] .pill-icon{ background:#111 !important; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.12)) !important; }

/* Ajustes quando o teclado estiver aberto (iOS 26):
   os botões já acompanham o viewport reduzido, então mantemos a mesma âncora */
html[data-vv-kb="1"] .floating-add-button,
html[data-vv-kb="1"] .floating-home-button {
  bottom: calc(12px + env(safe-area-inset-bottom));
}
.floating-add-button::before{content:"";position:absolute;inset:0;border-radius:inherit;border:1px solid #5a5a5a;opacity:.3;pointer-events:none;z-index:1;}
.floating-home-button::before{content:"";position:absolute;inset:0;border-radius:inherit;border:1px solid #5a5a5a;opacity:.3;pointer-events:none;z-index:1;}
/* Oculta botões flutuantes quando um modal está aberto (ficariam acima do modal) */
html.modal-open .floating-add-button,
html.modal-open .floating-home-button,
html.modal-open .floating-pill {
  opacity: 0.6;
  pointer-events: auto;
}
html.modal-open .floating-pill .pill-option{
  pointer-events: auto;
}

.floating-planned-button,.floating-card-button{
  position:absolute;top:18px;width:44px;height:44px;border-radius:50%;background:linear-gradient(to bottom,#00CFFF,#007AFF);
  box-shadow:0 4px 10px rgba(0,0,0,.3);display:flex;align-items:center;justify-content:center;color:#fff;font-size:24px;border:none;cursor:pointer;z-index:1100;
  transition:transform .12s ease, box-shadow .12s ease;
  animation:pulse 4s ease-in-out infinite;
  clip-path: circle(50% at 50% 50%);
  -webkit-tap-highlight-color: transparent;
}

/* ===================== LIGHT THEME — TX MODAL ===================== */
/* Froster light panel with subtle border/shadow; dark text only for TX modal */
html[data-theme="light"] #txModal .bottom-modal-box {
  background: radial-gradient(circle at top left, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.78) 60%), rgba(255,255,255,0.78) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #txModal h2 { color: #111; text-shadow: none; }
html[data-theme="light"] #txModal .modal-close-btn { color: #111; opacity: .7; }
html[data-theme="light"] #txModal .modal-close-btn:hover { opacity: 1; }
html[data-theme="light"] #txModal .modal-drag { background: #cfcfcf; }

/* Inputs/selects/date: clear white fields with gentle focus ring */
html[data-theme="light"] #txModal .form-grid input,
html[data-theme="light"] #txModal .form-grid select,
html[data-theme="light"] #txModal input[type="date"] {
  background: #fff;
  color: #111;
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.06);
}
html[data-theme="light"] #txModal .form-grid input:focus,
html[data-theme="light"] #txModal .form-grid select:focus,
html[data-theme="light"] #txModal input[type="date"]:focus {
  outline: none;
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(0,122,255,0.15);
}
html[data-theme="light"] #txModal ::placeholder { color: #6b7280; opacity: 1; }

/* Value +/- toggle in the amount field */
html[data-theme="light"] #txModal .value-toggle button {
  background: #f3f4f6;
  border: 1px solid rgba(0,0,0,0.08);
  color: #111;
  box-shadow: none;
}
html[data-theme="light"] #txModal .value-toggle button:not(.active) { opacity: .8; }
html[data-theme="light"] #txModal .value-toggle button[data-type="expense"] { background: #fee2e2; border-color: #fecaca; }
html[data-theme="light"] #txModal .value-toggle button[data-type="income"] { background: #dcfce7; border-color: #bbf7d0; }
html[data-theme="light"] #txModal .value-toggle button.active[data-type="expense"] { background: #fecaca; border-color: #ef4444; }
html[data-theme="light"] #txModal .value-toggle button.active[data-type="income"] { background: #bbf7d0; border-color: #16a34a; }

/* Method segmented control */
html[data-theme="light"] #txModal .method-switch {
  background: rgba(0,0,0,0.06);
  border: 1px solid rgba(0,0,0,0.08);
}
html[data-theme="light"] #txModal .method-switch .switch-option { color: #111; }
html[data-theme="light"] #txModal .method-switch .switch-option.active { color: #111; }
html[data-theme="light"] #txModal .method-switch .switch-highlight {
  background: #fff;
  border: 1px solid rgba(0,0,0,0.10);
  box-shadow: 0 1px 2px rgba(0,0,0,0.06);
}

/* Card selector list in Cartão mode */
html[data-theme="light"] #txModal #cardSelector label {
  background: rgba(255,255,255,0.85);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
  backdrop-filter: blur(12px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.08);
  color: #111;
}
html[data-theme="light"] #txModal #cardSelector input[type="radio"] {
  border-color: #6b7280;
}
html[data-theme="light"] #txModal #cardSelector input[type="radio"]:checked {
  background-color: var(--blue);
  border-color: var(--blue);
}

/* CTA button */
html[data-theme="light"] #txModal #addBtn {
  background: #16a34a; /* emerald-600 */
  color: #fff;
  border: 1px solid rgba(0,0,0,0.08);
  box-shadow: 0 8px 18px rgba(22,163,74,0.22);
}
html[data-theme="light"] #txModal #addBtn:hover { filter: brightness(1.05); }
html[data-theme="light"] #txModal #addBtn:active { filter: brightness(0.98); }

/* Invoice parcel row label */
html[data-theme="light"] #txModal #invoiceParcelRow { color: #111; }

/* ===================== LIGHT THEME — SETTINGS (AJUSTES) ===================== */
/* Panel */
html[data-theme="light"] #settingsModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.86) 0%, rgba(255,255,255,0.80) 60%), rgba(255,255,255,0.80) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #settingsModal .settings-modal-header {
  background: transparent;
  border: none;
  box-shadow: none;
}
html[data-theme="light"] #settingsModal .settings-modal-header h2 {
  color: #111;
}
html[data-theme="light"] #settingsModal h2 { color:#111; text-shadow:none; }
html[data-theme="light"] #settingsModal .modal-close-btn { color:#111; opacity:.7; }
html[data-theme="light"] #settingsModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #settingsModal .modal-drag{ background:#cfcfcf; }
html[data-theme="light"] .sheet-header h2 {
  color: #111;
  text-shadow: none;
}

/* Cards and list groups */
html[data-theme="light"] #settingsModal .settings-card,
html[data-theme="light"] #settingsModal .settings-list{
  background: rgba(255,255,255,0.85);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
  backdrop-filter: blur(12px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.10);
  box-shadow: 0 8px 18px rgba(0,0,0,0.10);
}
html[data-theme="light"] #settingsModal .settings-item{ border-top:1px solid rgba(0,0,0,0.06); }
html[data-theme="light"] #settingsModal .settings-name{ color:#111; }
html[data-theme="light"] #settingsModal .settings-sub{ color:#4b5563; opacity:1; }
html[data-theme="light"] #settingsModal .settings-avatar{ background:#e5e7eb; border-color: rgba(0,0,0,0.10); }

/* Theme segmented control */
html[data-theme="light"] #settingsModal .settings-theme-card{
  background: rgba(0,0,0,0.06);
  border: 1px solid rgba(0,0,0,0.08);
  box-shadow: 0 4px 10px rgba(0,0,0,0.06);
}
html[data-theme="light"] #settingsModal .settings-theme-card .theme-row{ border-top: none; }
html[data-theme="light"] #settingsModal .settings-theme-card .theme-row .theme-btn{ color:#111; }
html[data-theme="light"] #settingsModal .settings-theme-card .theme-row .theme-btn + .theme-btn::before{ background: rgba(0,0,0,0.08); }
html[data-theme="light"] #settingsModal .settings-theme-card .theme-row .theme-btn[aria-pressed="true"]{
  background:#fff;
  color:#111;
  box-shadow: inset 0 3px 8px rgba(0,0,0,0.08);
}
html[data-theme="light"] #settingsModal .settings-theme-card .theme-row .theme-btn[aria-pressed="true"]::after{ background: radial-gradient(ellipse at center, rgba(0,0,0,0.10), rgba(0,0,0,0)); }

/* Version section light theme */
html[data-theme="light"] .version-number {
  color: #111;
  opacity: 0.7;
}

/* Danger action */
html[data-theme="light"] #settingsModal .settings-item .settings-cta{ color:#111; }
html[data-theme="light"] #settingsModal .settings-item.danger .settings-cta{ color:#ef4444; }
html[data-theme="light"] #settingsModal .settings-item.danger .settings-icon{ background:#ef4444; }
html[data-theme="light"] #settingsModal #settingsCardsBtn .left,
html[data-theme="light"] #settingsModal #settingsCardsBtn .right {
  color: #111;
}

/* ===================== LIGHT THEME — CARD MODAL ===================== */
/* Panel */
html[data-theme="light"] #cardModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.86) 0%, rgba(255,255,255,0.80) 60%), rgba(255,255,255,0.80) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #cardModal h2{ color:#111; text-shadow:none; }
html[data-theme="light"] #cardModal .modal-close-btn{ color:#111; opacity:.7; }
html[data-theme="light"] #cardModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #cardModal .modal-drag{ background:#cfcfcf; }

/* Inputs */
html[data-theme="light"] #cardModal input,
html[data-theme="light"] #cardModal select{
  background:#fff;
  color:#111;
  border:1px solid rgba(0,0,0,0.12);
  box-shadow: inset 0 1px 2px rgba(0,0,0,0.06);
}
html[data-theme="light"] #cardModal input:focus,
html[data-theme="light"] #cardModal select:focus{
  outline:none;
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(0,122,255,0.15);
}
html[data-theme="light"] #cardModal ::placeholder{ color:#6b7280; opacity:1; }

/* CTA */
html[data-theme="light"] #cardModal #addCardBtn{
  background:#16a34a; /* emerald-600 */
  color:#fff;
  border:1px solid rgba(0,0,0,0.08);
  box-shadow: 0 8px 18px rgba(22,163,74,0.22);
}
html[data-theme="light"] #cardModal #addCardBtn:hover{ filter: brightness(1.05); }
html[data-theme="light"] #cardModal #addCardBtn:active{ filter: brightness(0.98); }

/* Helper text */
html[data-theme="light"] #cardModal small{ color:#6b7280; }

/* Card list entries */
html[data-theme="light"] #cardModal .card-list li .card-line{
  background:#ffffffec; /* slightly translucent to keep frosted feel */
  border:1px solid rgba(0,0,0,0.10);
  border-radius:14px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.08);
  color:#111;
}
html[data-theme="light"] #cardModal .card-list li .card-line .card-name{ color:#111; }
html[data-theme="light"] #cardModal .card-list li .card-line .card-dates{ color:#374151; }

/* If swipe wrapper is in use inside card modal */
html[data-theme="light"] #cardModal .swipe-wrapper .card-line{
  background:#ffffffec;
  border:1px solid rgba(0,0,0,0.10);
  border-radius:14px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.08);
  color:#111;
}
/* Ensure detail labels/values are readable on white */
html[data-theme="light"] #cardModal .card-detail{ color:#111; }
html[data-theme="light"] #cardModal .card-label{ color:#4b5563; }
html[data-theme="light"] #cardModal .card-value{ color:#111; }
html[data-theme="light"] #cardModal .card-content b{ color:#111; }

/* ===================== LIGHT THEME — PLANNED MODAL ===================== */
/* ===================== LIGHT THEME — CONFIRM MOVE MODAL ===================== */
html[data-theme="light"] #confirmMoveModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.86) 0%, rgba(255,255,255,0.80) 60%), rgba(255,255,255,0.80) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #confirmMoveModal h2{ color:#111; text-shadow:none; }
html[data-theme="light"] #confirmMoveModal .modal-close-btn{ color:#111; opacity:.7; }
html[data-theme="light"] #confirmMoveModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #confirmMoveModal .modal-drag{ background:#cfcfcf; }
/* Ensure body text inside confirm modal is dark on light glass */
html[data-theme="light"] #confirmMoveModal #confirmMoveText{ color:#111 !important; text-shadow:none; }

/* ===================== LIGHT THEME — CONFIRM LOGOUT MODAL ===================== */
html[data-theme="light"] #confirmLogoutModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.86) 0%, rgba(255,255,255,0.80) 60%), rgba(255,255,255,0.80) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #confirmLogoutModal h2{ color:#111; text-shadow:none; }
html[data-theme="light"] #confirmLogoutModal .modal-close-btn{ color:#111; opacity:.7; }
html[data-theme="light"] #confirmLogoutModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #confirmLogoutModal .modal-drag{ background:#cfcfcf; }
html[data-theme="light"] #confirmLogoutModal #confirmLogoutText{ color:#111 !important; text-shadow:none; }

/* ===================== LIGHT THEME — CONFIRM RESET MODAL (added) ===================== */
html[data-theme="light"] #confirmResetModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.92) 60%), rgba(255,255,255,0.92) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.08);
  box-shadow: 0 14px 36px rgba(0,0,0,0.12);
}
html[data-theme="light"] #confirmResetModal h2{ color:#111; text-shadow:none; }
html[data-theme="light"] #confirmResetModal .modal-close-btn{ color:#111; opacity:.8; }
html[data-theme="light"] #confirmResetModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #confirmResetModal .modal-drag{ background:#dcdcdc; }
html[data-theme="light"] #confirmResetModal #confirmResetText{ color:#111 !important; text-shadow:none; }
html[data-theme="light"] #confirmResetModal #confirmResetYes{ background:#ef4444; color:#fff; border:1px solid rgba(0,0,0,0.06); }
html[data-theme="light"] #confirmResetModal #confirmResetNo{ background:#fff; color:#6b7280; border:1px solid rgba(0,0,0,0.06); }


/* ===================== LIGHT THEME — DELETE RECURRENCE MODAL ===================== */
html[data-theme="light"] #deleteRecurrenceModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.86) 0%, rgba(255,255,255,0.80) 60%), rgba(255,255,255,0.80) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #deleteRecurrenceModal h2{ color:#111; text-shadow:none; }
html[data-theme="light"] #deleteRecurrenceModal .modal-close-btn{ color:#111; opacity:.7; }
html[data-theme="light"] #deleteRecurrenceModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #deleteRecurrenceModal .modal-drag{ background:#cfcfcf; }

/* ===================== LIGHT THEME — EDIT RECURRENCE MODAL ===================== */
html[data-theme="light"] #editRecurrenceModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.86) 0%, rgba(255,255,255,0.80) 60%), rgba(255,255,255,0.80) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #editRecurrenceModal h2{ color:#111; text-shadow:none; }
html[data-theme="light"] #editRecurrenceModal .modal-close-btn{ color:#111; opacity:.7; }
html[data-theme="light"] #editRecurrenceModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #editRecurrenceModal .modal-drag{ background:#cfcfcf; }

/* Panel */
html[data-theme="light"] #plannedModal .bottom-modal-box{
  background: radial-gradient(circle at top left, rgba(255,255,255,0.86) 0%, rgba(255,255,255,0.80) 60%), rgba(255,255,255,0.80) !important;
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: 0 14px 36px rgba(0,0,0,0.18);
}
html[data-theme="light"] #plannedModal h2{ color:#111; text-shadow:none; }
html[data-theme="light"] #plannedModal .modal-close-btn{ color:#111; opacity:.7; }
html[data-theme="light"] #plannedModal .modal-close-btn:hover{ opacity:1; }
html[data-theme="light"] #plannedModal .modal-drag{ background:#cfcfcf; }

/* Headings and day labels */
html[data-theme="light"] #plannedModal .subheader,
html[data-theme="light"] #plannedModal .planned-date,
html[data-theme="light"] #plannedModal .modal-content h3{ color:#111; text-shadow:none; }

/* Cards: row visuals (already covered globally for .planned-list) + text colors */
html[data-theme="light"] #plannedModal .planned-list > li .op-line{
  background:#fff !important;
  border:1px solid rgba(0,0,0,0.08) !important;
  box-shadow: 0 6px 14px rgba(0,0,0,0.08) !important;
}
/* Description and method */
html[data-theme="light"] #plannedModal .planned-list > li .op-left span:not(.method){ color:#111 !important; }
html[data-theme="light"] #plannedModal .planned-list > li .op-left .method{ color:#6b7280 !important; }
/* When a checkbox is present, ensure the adjacent description text is dark too */
html[data-theme="light"] #plannedModal .planned-list .op-left input.plan-check + span { color:#111 !important; }

/* Checkbox style in light */
html[data-theme="light"] #plannedModal .planned-list .op-left input.plan-check{
  background:#fff;
  border-color:#9ca3af;
  box-shadow: 0 4px 12px rgba(0,0,0,0.10);
}
html[data-theme="light"] #plannedModal .planned-list .op-left input.plan-check:checked{
  background: var(--blue);
  border-color: var(--blue);
}

/* Values: flat colors (override gradient text) */
html[data-theme="light"] #plannedModal .planned-list .op-right .value{ color:#111; background:none; -webkit-text-fill-color: initial; font-weight:700; }
html[data-theme="light"] #plannedModal .planned-list .op-right .value.negative{
  background:none !important; -webkit-text-fill-color: initial !important; color:#dc2626 !important;
}
html[data-theme="light"] #plannedModal .planned-list .op-right .value.positive{
  background:none !important; -webkit-text-fill-color: initial !important; color:#16a34a !important;
}
.floating-planned-button{right:90px;}
.floating-card-button{right:20px;}

.floating-planned-button:hover,
.floating-card-button:hover{
  box-shadow:0 6px 16px rgba(0,0,0,.6), 0 0 12px #00FF0080;
  transform:scale(.97);
}

.floating-planned-button:active,
.floating-card-button:active{
  transform:scale(.97);
}

/* ===================== TOAST ===================== */
.toast{
  position:fixed;
  top:calc(var(--header-h,80px) + env(safe-area-inset-top) + 8px);
  left:50%;
  transform:translate(-50%, -100%);      /* starts hidden above view */
  max-width:90vw;
  display:inline-flex;                    /* pill grows with content */
  align-items:center;
  gap:8px;                                /* space for icon */
  padding:12px 20px;
  border-radius:9999px;                   /* always pill‑shaped */
  backdrop-filter:blur(12px) saturate(180%);
  box-shadow:0 4px 12px rgba(0,0,0,.3);
  font-weight:600;
  color:#fff;
  opacity:0;
  pointer-events:none;
  transition:
    transform .45s cubic-bezier(.22,1,.36,1),
    opacity   .35s ease;
  z-index:950;
}
.toast.show{
  transform:translate(-50%, 0);           /* slides down */
  opacity:1;
}
.toast.success{
  /* subtle green tint with frosted‑glass translucency */
  background:rgba(0,255,0,.18);
}
.toast.error{
  /* subtle red tint with frosted‑glass translucency */
  background:rgba(255,0,0,.18);
}
.toast::before{
  content:var(--icon,'✓');
  font-size:1.2rem;
  line-height:1;
  margin-right:6px;
}

/* ===================== ANIMS ===================== */
.flash-highlight{animation:flash 1s ease-in-out;}
@keyframes flash{from{background-color:rgba(255,255,0,.6);}to{background-color:transparent;}}
@keyframes fadeSlideIn{from{opacity:0;transform:translateY(-10px);}to{opacity:1;transform:translateY(0);}}
@keyframes fadeSlideOut{from{opacity:1;transform:translateY(0);}to{opacity:0;transform:translateY(-10px);}}

details.month[open] > details.day{animation:fadeSlideIn .5s ease-out;}

/* ===================== UPDATE BANNER ===================== */
.update-banner {
  position: fixed;
  left: 12px;
  right: 12px;
  bottom: calc(12px + env(safe-area-inset-bottom));
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 14px;
  border-radius: 12px;
  background: rgba(30,30,30,.92);
  color: #fff;
  box-shadow: 0 8px 24px rgba(0,0,0,.35);
  z-index: 1400;
  backdrop-filter: blur(8px) saturate(150%);
}
.update-banner button {
  appearance: none;
  border: none;
  border-radius: 10px;
  background: linear-gradient(180deg, #00C853, #00A94F);
  color: #fff;
  padding: 8px 12px;
  font-weight: 700;
  letter-spacing: .2px;
  box-shadow: 0 2px 8px rgba(0,0,0,.25);
}
.update-banner button:disabled {
  opacity: .75;
}
details.month:not([open]) > details.day{animation:fadeSlideOut .5s ease-in;}
details.day[open] > .swipe-wrapper,
details.day[open] > .planned-cash,
details.day[open] > .executed-cash,
details.day[open] > .invoice{animation:fadeSlideIn .5s ease-out;}
details.day:not([open]) > .swipe-wrapper,
details.day:not([open]) > .planned-cash,
details.day:not([open]) > .executed-cash,
details.day:not([open]) > .invoice{animation:fadeSlideOut .5s ease-in;}

@keyframes pulse{
  0%,100%{opacity:1;}
  50%   {opacity:.8;}
}

/* ===================== MISC ===================== */

.recurring-icon{margin-left:4px;font-size:.9em;color:var(--timestamp);} 
.day-tabs{display:flex;gap:8px;margin:8px 0;}
.day-tabs .tab{background:transparent;border:none;font-weight:600;padding:4px 8px;cursor:pointer;color:#666;}
.day-tabs .tab.active{color:#000;border-bottom:2px solid #000;}
.tab-content{padding-left:8px;}

.day-title{font-weight:400;letter-spacing:-.2px;}
.day-value{font-weight:600;}
summary.day-summary:hover{box-shadow:0 8px 24px rgba(0,0,0,.55), 0 0 12px #00FF0080;}


/* Modal Cartões: keep original card-list layout with swipe underneath */
#cardModal .card-list li {
  margin-bottom: 12px;
}
#cardModal .card-list li {
  /* ensure children (swipe actions / shadows) are clipped to rounded corners */
  overflow: hidden;
  border-radius: 12px; /* match .card-line radius */
}
#cardModal .card-list .swipe-wrapper {
  background: transparent !important;
  padding: 0 !important;
}
#cardModal .card-list .swipe-actions {
  /* keep actions hidden until swipe, no background here */
  background: transparent !important;
}
#cardModal .card-list .swipe-wrapper {
  /* clip any absolutely positioned actions behind the card line */
  overflow: hidden;
  border-radius: 12px;
}
#cardModal .card-list .card-line {
  background: rgba(42, 44, 44, 0.8);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border-radius: 12px;
  padding: 12px;
  color: #fff;
}

#cardModal.from-settings .bottom-modal-box {
  transform: translateX(32px);
  opacity: 0;
  transition: transform .28s cubic-bezier(.22, 1, .36, 1), opacity .28s ease;
}

#cardModal.from-settings.from-settings-visible .bottom-modal-box {
  transform: translateX(0);
  opacity: 1;
}

#cardModal.card-slide .bottom-modal-box {
  transform: translateX(32px);
  opacity: 0;
  transition: transform .28s cubic-bezier(.22, 1, .36, 1), opacity .28s ease;
}

#cardModal.card-slide.card-slide-visible .bottom-modal-box {
  transform: translateX(0);
  opacity: 1;
}
.card-content {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
/* No modal de cartões, garanta que cada linha (ícone+label e valor) fiquem nos extremos */
#cardModal .card-detail {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}
.card-icon svg {
  width: 1em;
  height: 1em;
  flex-shrink: 0;
}
.card-label {
  color: rgba(255,255,255,0.8);
  font-size: 0.9rem;
}
.card-value {
  margin-left: auto;
  font-weight: 600;
  color: #fff;
}
.card-content b {
  color: #fff;
}

/* Hide scrollbars (app and modals) */
.wrapper,
.modal-content,
.bottom-modal,
.bottom-modal-box {
  -ms-overflow-style: none;     /* IE/Edge legacy */
  scrollbar-width: none;        /* Firefox */
}
.wrapper::-webkit-scrollbar,
.modal-content::-webkit-scrollbar,
.bottom-modal::-webkit-scrollbar,
.bottom-modal-box::-webkit-scrollbar {
  width: 0 !important;
  height: 0 !important;
}
/* Mensagem de ajuda abaixo do botão Adicionar */
.bottom-modal-box small {
  display: block;
  margin-top: 8px;
  font-size: 0.8rem;
  font-style: italic;
  color: rgba(255, 255, 255, 0.7);
  text-align: center;
  line-height: 1.4;
}

/* Planned items as cards in Planned Modal */
/* Planned items as cards in Planned Modal */
#plannedModal #plannedList > li.planned-cash {
  background: rgba(255,255,255,0.08);
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  padding: 12px 16px;
  border-radius: 10px;
  /* switch from flex to grid to control placement */
  display: grid;
  grid-template-columns: minmax(0,1fr) auto; /* descrição cresce, valor encosta à direita */
  grid-template-rows: auto auto;            /* linha 1: desc/valor, linha 2: método */
  column-gap: 12px;
  row-gap: 2px;
  align-items: center;
  font-family: 'Inter', sans-serif;
  line-height: 1.5;
  min-height: 44px;
  margin-bottom: 8px;
  width: 100%;
  box-sizing: border-box;
}

/* Grid-based layout for planned modal children */
/* Grid-based layout for planned modal children */
#plannedModal #plannedList .planned-cash .op-main { display: contents; }
#plannedModal #plannedList .planned-cash .op-left { grid-column: 1; grid-row: 1; min-width: 0; }
#plannedModal #plannedList .planned-cash .op-right { display: contents; }
#plannedModal #plannedList .planned-cash .op-right .value {
  grid-column: 2;
  grid-row: 1;
  justify-self: end;
  text-align: right;
  font-weight: 600;
}
/* Qualquer conteúdo da direita que não seja o valor vira a linha de método, abaixo da descrição */
#plannedModal #plannedList .planned-cash .op-right > :not(.value),
#plannedModal #plannedList .planned-cash .method {
  grid-column: 1;
  grid-row: 2;
  justify-self: start;
  align-self: start;
  margin-top: 2px;
  font-size: 0.9rem;
  color: var(--txt-muted);
  margin-left: 100px !important;
  padding-left: 100px !important;
}
/* Guard rails: prevent horizontal overflow in bottom modals */
.bottom-modal,
.bottom-modal-box,
.modal-content {
  overflow-x: hidden;
}

/* ------------------------------------------------------------------------
   Styles moved from index.html inline block
   These rules ensure consistency for the recurrence modal buttons,
   parcel block animations, and card modal scrolling.
   -------------------------------------------------------------------- */
/* Action buttons for recurrence modal */
.action-btn {
  padding: 14px 0;
  width: 100%;
  border-radius: 18px;
  font-size: 1rem;
  font-weight: bold;
  border: none;
  background: #ededed;
  margin-bottom: 8px;
  cursor: pointer;
  transition: background 0.2s;
}
.action-btn:not(.cancel-btn):hover {
  background: #e0e0e0;
}
.cancel-btn {
  background: #f5f5f5;
  color: #888;
}
.danger-btn {
  background: #ff6b6b !important;
  color: #fff !important;
}
.danger-btn:hover { background: #ff5252 !important; }
.reset-data-btn {
  padding: 12px 14px;
  width: 100%;
  border-radius: 12px;
  background: #c53030;
  color: #fff;
  border: none;
  font-weight: 700;
  cursor: pointer;
}
.reset-data-btn:hover { background: #b02222; }
/* Ensure dialog warning text is readable on dark and light themes */
#confirmResetModal .form-grid p,
#confirmLogoutModal .form-grid p {
  color: var(--txt-main) !important;
  opacity: 0.95 !important;
}
/* Parcelas: colapsa/expande suavemente */
#parcelasBlock {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}
#parcelasBlock.hidden {
  display: none;
  max-height: 0;
}
#parcelasBlock:not(.hidden) {
  max-height: 120px;   /* altura suficiente para o select */
}
#parcelasBlock select {
  margin-top: 4px;
}

/* Override bottom-modal-box input/select background to light gray */
.bottom-modal-box input:not([type="radio"]):not([type="checkbox"]), .bottom-modal-box select {
  font-size: 1rem;
  border-radius: 16px;
  padding: 10px;
  border: none;
  background: rgba(255,255,255,0.15);
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.2), 0 4px 12px rgba(0,0,0,0.4);
  margin-bottom: 10px;
  width: 100%;
  box-sizing: border-box;
}

/* Toast: prevent text wrapping for aesthetic single-line messages */
.toast {
  white-space: nowrap;
}
/* —— FIXCorrija o sinal do ajuste no saldo do dia;
Implemente o pagamento parcial sem parcelar criando um invoiceAdjust do valor pago e uma transação “Rollover fatura – <cartão>” para o próximo vencimento com o restante (como transação do cartão, para compor a próxima fatura);
Opcional: atualizar o header da fatura para mostrar “total líquido” (total − ajustes) e/ou um badge com restante?: header icons overlapping the segmented control —— */
#enablePushBtn{ position: static !important; right: auto; top: auto; width:44px; height:44px; display:inline-flex; align-items:center; justify-content:center; background: rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.18); border-radius:14px; box-shadow:0 2px 6px rgba(0,0,0,.45); }
#offlineIndicator{ position: static !important; right: auto; top: auto; width:40px; height:40px; display:flex; align-items:center; justify-content:center; }
/* keep the segmented control from pushing over icons */
.header-seg{ margin-left: 0; margin-right: 0; }
/* ===================== SKELETON (light shimmer) ===================== */
@keyframes skeletonShimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
.skeleton{position:relative;display:inline-block;background:linear-gradient(90deg, rgba(255,255,255,.10), rgba(255,255,255,.18), rgba(255,255,255,.10));background-size:200% 100%;animation:skeletonShimmer 1.2s ease-in-out infinite;border-radius:8px;color:transparent;}
.skeleton-pill{height:16px;min-width:80px;border-radius:9999px;}
.skeleton-line{height:12px;width:120px;border-radius:6px;}
.skeleton-small{height:10px;width:80px;border-radius:6px;}
#accordion .month-divider .s-meta .skeleton-pill{margin-left:auto;}
#accordion .day-summary .skeleton-pill{margin-left:auto;}

/* Light theme: use subtle gray shimmer instead of white (better contrast on light bg) */
html[data-theme="light"] .skeleton{
  background: linear-gradient(90deg,
    rgba(0,0,0,0.14),
    rgba(0,0,0,0.24),
    rgba(0,0,0,0.14)
  );
}

/* Light theme: ensure shimmer is visible inside month headers/meta (overrides earlier resets) */
html[data-theme="light"] summary.month-divider .skeleton,
html[data-theme="light"] summary.month-divider .skeleton-pill,
html[data-theme="light"] summary.month-divider .s-meta .skeleton,
html[data-theme="light"] summary.month-divider .s-meta .skeleton-pill,
html[data-theme="light"] .month-meta .skeleton,
html[data-theme="light"] .month-meta .skeleton-pill,
html[data-theme="light"] summary.month-divider .meta-value .skeleton,
html[data-theme="light"] .month-meta .meta-value .skeleton{
  background: linear-gradient(90deg, rgba(0,0,0,0.14), rgba(0,0,0,0.24), rgba(0,0,0,0.14)) !important;
  background-size: 200% 100% !important;
  animation: skeletonShimmer 1.2s ease-in-out infinite !important;
  color: transparent !important;
  border-radius: 9999px !important;
}

/* Hide start-balance box only during skeleton boot */
html.skeleton-boot #startGroup,
html.skeleton-boot .start-container,
html.skeleton-boot #dividerSaldo { display: none !important; }

/* ===================== THEME VARIABLES ===================== */
:root {
  --op-left-color: #1e1e1e;
}

html[data-theme="dark"] {
  --op-left-color: #ffffff;
}

html[data-theme="dark"] .year-indicator {
  color: #ffffff;
}
